<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Docker åŸºç¡€ | Blaine&#39;s Blog</title>
<meta name="keywords" content="docker">
<meta name="description" content="Docker ä¸ºä»€ä¹ˆä½¿ç”¨Docker ä¼ä¸šç¯å¢ƒä¸­å­˜åœ¨çš„æŸä¸ªç—›ç‚¹ ä¼ä¸šä½¿ç”¨ä¸€é¡¹æŠ€æœ¯æ˜¯ä¸ºäº†è§£å†³å½“å‰ä¼ä¸šç¯å¢ƒä¸­å­˜åœ¨çš„æŸä¸ªç—›ç‚¹ã€‚ ç›®å‰æ•´ä¸ªè½¯ä»¶è¡Œä¸šå­˜åœ¨ç€ä»¥ä¸‹å‡ ä¸ªç—›ç‚¹ã€‚ 1.è½¯ä»¶æ›´æ–°å‘å¸ƒåŠéƒ¨ç½²ä½æ•ˆï¼Œè¿‡ç¨‹çƒ¦çä¸”éœ€è¦äººå·¥ä»‹å…¥ã€‚ 2.ç¯å¢ƒä¸€è‡´æ€§éš¾ä»¥ä¿è¯ã€‚ 3.ä¸åŒç¯å¢ƒä¹‹é—´è¿ç§»æˆæœ¬å¤ªé«˜ã€‚ Dockerèƒ½è§£å†³çš„é—®é¢˜ é¦–å…ˆï¼ŒDo">
<meta name="author" content="Blaine">
<link rel="canonical" href="https://Bin-lin-rgb.github.io/posts/deploy/docker/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://Bin-lin-rgb.github.io/img/icon.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://Bin-lin-rgb.github.io/img/icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://Bin-lin-rgb.github.io/img/icon.png">
<link rel="apple-touch-icon" href="https://Bin-lin-rgb.github.io/img/icon.png">
<link rel="mask-icon" href="https://Bin-lin-rgb.github.io/img/icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script defer src="https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js"></script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = ""; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<meta property="og:title" content="Docker åŸºç¡€" />
<meta property="og:description" content="Docker ä¸ºä»€ä¹ˆä½¿ç”¨Docker ä¼ä¸šç¯å¢ƒä¸­å­˜åœ¨çš„æŸä¸ªç—›ç‚¹ ä¼ä¸šä½¿ç”¨ä¸€é¡¹æŠ€æœ¯æ˜¯ä¸ºäº†è§£å†³å½“å‰ä¼ä¸šç¯å¢ƒä¸­å­˜åœ¨çš„æŸä¸ªç—›ç‚¹ã€‚ ç›®å‰æ•´ä¸ªè½¯ä»¶è¡Œä¸šå­˜åœ¨ç€ä»¥ä¸‹å‡ ä¸ªç—›ç‚¹ã€‚ 1.è½¯ä»¶æ›´æ–°å‘å¸ƒåŠéƒ¨ç½²ä½æ•ˆï¼Œè¿‡ç¨‹çƒ¦çä¸”éœ€è¦äººå·¥ä»‹å…¥ã€‚ 2.ç¯å¢ƒä¸€è‡´æ€§éš¾ä»¥ä¿è¯ã€‚ 3.ä¸åŒç¯å¢ƒä¹‹é—´è¿ç§»æˆæœ¬å¤ªé«˜ã€‚ Dockerèƒ½è§£å†³çš„é—®é¢˜ é¦–å…ˆï¼ŒDo" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://Bin-lin-rgb.github.io/posts/deploy/docker/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-28T18:35:29+08:00" />
<meta property="article:modified_time" content="2023-10-28T18:35:29+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Docker åŸºç¡€"/>
<meta name="twitter:description" content="Docker ä¸ºä»€ä¹ˆä½¿ç”¨Docker ä¼ä¸šç¯å¢ƒä¸­å­˜åœ¨çš„æŸä¸ªç—›ç‚¹ ä¼ä¸šä½¿ç”¨ä¸€é¡¹æŠ€æœ¯æ˜¯ä¸ºäº†è§£å†³å½“å‰ä¼ä¸šç¯å¢ƒä¸­å­˜åœ¨çš„æŸä¸ªç—›ç‚¹ã€‚ ç›®å‰æ•´ä¸ªè½¯ä»¶è¡Œä¸šå­˜åœ¨ç€ä»¥ä¸‹å‡ ä¸ªç—›ç‚¹ã€‚ 1.è½¯ä»¶æ›´æ–°å‘å¸ƒåŠéƒ¨ç½²ä½æ•ˆï¼Œè¿‡ç¨‹çƒ¦çä¸”éœ€è¦äººå·¥ä»‹å…¥ã€‚ 2.ç¯å¢ƒä¸€è‡´æ€§éš¾ä»¥ä¿è¯ã€‚ 3.ä¸åŒç¯å¢ƒä¹‹é—´è¿ç§»æˆæœ¬å¤ªé«˜ã€‚ Dockerèƒ½è§£å†³çš„é—®é¢˜ é¦–å…ˆï¼ŒDo"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [

        {
          "@type": "ListItem",
          "position":  1 ,
          "name": "ğŸ“šæ–‡ç« ",
          "item": "https://Bin-lin-rgb.github.io/posts/"
        },

        {
          "@type": "ListItem",
          "position":  2 ,
          "name": "â¬ Deploy",
          "item": "https://Bin-lin-rgb.github.io/posts/deploy/"
        }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Docker åŸºç¡€",
      "item": "https://Bin-lin-rgb.github.io/posts/deploy/docker/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Docker åŸºç¡€",
  "name": "Docker åŸºç¡€",
  "description": "Docker ä¸ºä»€ä¹ˆä½¿ç”¨Docker ä¼ä¸šç¯å¢ƒä¸­å­˜åœ¨çš„æŸä¸ªç—›ç‚¹ ä¼ä¸šä½¿ç”¨ä¸€é¡¹æŠ€æœ¯æ˜¯ä¸ºäº†è§£å†³å½“å‰ä¼ä¸šç¯å¢ƒä¸­å­˜åœ¨çš„æŸä¸ªç—›ç‚¹ã€‚ ç›®å‰æ•´ä¸ªè½¯ä»¶è¡Œä¸šå­˜åœ¨ç€ä»¥ä¸‹å‡ ä¸ªç—›ç‚¹ã€‚ 1.è½¯ä»¶æ›´æ–°å‘å¸ƒåŠéƒ¨ç½²ä½æ•ˆï¼Œè¿‡ç¨‹çƒ¦çä¸”éœ€è¦äººå·¥ä»‹å…¥ã€‚ 2.ç¯å¢ƒä¸€è‡´æ€§éš¾ä»¥ä¿è¯ã€‚ 3.ä¸åŒç¯å¢ƒä¹‹é—´è¿ç§»æˆæœ¬å¤ªé«˜ã€‚ Dockerèƒ½è§£å†³çš„é—®é¢˜ é¦–å…ˆï¼ŒDo",
  "keywords": [
    "docker"
  ],
  "articleBody": "Docker ä¸ºä»€ä¹ˆä½¿ç”¨Docker\nä¼ä¸šç¯å¢ƒä¸­å­˜åœ¨çš„æŸä¸ªç—›ç‚¹ ä¼ä¸šä½¿ç”¨ä¸€é¡¹æŠ€æœ¯æ˜¯ä¸ºäº†è§£å†³å½“å‰ä¼ä¸šç¯å¢ƒä¸­å­˜åœ¨çš„æŸä¸ªç—›ç‚¹ã€‚\nç›®å‰æ•´ä¸ªè½¯ä»¶è¡Œä¸šå­˜åœ¨ç€ä»¥ä¸‹å‡ ä¸ªç—›ç‚¹ã€‚\n1.è½¯ä»¶æ›´æ–°å‘å¸ƒåŠéƒ¨ç½²ä½æ•ˆï¼Œè¿‡ç¨‹çƒ¦çä¸”éœ€è¦äººå·¥ä»‹å…¥ã€‚\n2.ç¯å¢ƒä¸€è‡´æ€§éš¾ä»¥ä¿è¯ã€‚\n3.ä¸åŒç¯å¢ƒä¹‹é—´è¿ç§»æˆæœ¬å¤ªé«˜ã€‚\nDockerèƒ½è§£å†³çš„é—®é¢˜ é¦–å…ˆï¼ŒDockerçš„ä½¿ç”¨ååˆ†ç®€å•ï¼Œ\nä»å¼€å‘çš„è§’åº¦æ¥çœ‹å°±æ˜¯â€œä¸‰æ­¥èµ°\"ï¼šæ„å»ºã€è¿è¾“ã€è¿è¡Œã€‚\nå…¶ä¸­ï¼Œå…³é”®æ­¥éª¤æ˜¯æ„å»ºç¯èŠ‚ï¼Œå³æ‰“åŒ…é•œåƒæ–‡ä»¶ã€‚\nä½†æ˜¯ä»æµ‹è¯•å’Œè¿ç»´çš„è§’åº¦æ¥çœ‹ï¼Œé‚£å°±åªæœ‰ä¸¤æ­¥ï¼šå¤åˆ¶ã€è¿è¡Œã€‚\næœ‰äº†è¿™ä¸ªé•œåƒæ–‡ä»¶ï¼Œæƒ³å¤åˆ¶åˆ°å“ªé‡Œè¿è¡Œéƒ½å¯ä»¥ï¼Œå®Œå…¨å’Œå¹³å°æ— å…³ã€‚\nDockerè¿™ç§å®¹å™¨æŠ€æœ¯éš”ç¦»å‡ºäº†ç‹¬ç«‹çš„è¿è¡Œç©ºé—´ï¼Œä¸ä¼šå’Œå…¶ä»–åº”ç”¨äº‰ç”¨ç³»ç»Ÿèµ„æºï¼Œä¸éœ€è¦è€ƒè™‘åº”ç”¨ä¹‹é—´çš„ç›¸äº’å½±å“ã€‚\nå…¶æ¬¡ï¼Œå› ä¸ºåœ¨æ„å»ºé•œåƒæ—¶å°±å¤„ç†å®Œäº†æœåŠ¡ç¨‹åºå¯¹äºç³»ç»Ÿçš„æ‰€æœ‰ä¾èµ–ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨æ—¶ï¼Œå¯ä»¥å¿½ç•¥åŸæœ¬ç¨‹åºçš„ä¾èµ–ä»¥åŠå¼€å‘è¯­è¨€ã€‚å¯¹æµ‹è¯•å’Œè¿ç»´äººå‘˜è€Œè¨€ï¼Œå¯ä»¥æ›´ä¸“æ³¨äºè‡ªå·±çš„ä¸šåŠ¡å†…å®¹ã€‚\næœ€åï¼ŒDockerä¸ºå¼€å‘è€…æä¾›äº†ä¸€ç§å¼€å‘ç¯å¢ƒçš„ç®¡ç†åŠæ³•ï¼Œå¸®åŠ©æµ‹è¯•äººå‘˜ä¿è¯ç¯å¢ƒçš„åŒæ­¥ï¼Œä¸ºè¿ç»´äººå‘˜æä¾›äº†å¯ç§»æ¤çš„æ ‡å‡†åŒ–éƒ¨ç½²æµç¨‹ã€‚\nç±» â€“\u003e å¯¹è±¡\né•œåƒ â€“\u003e å®¹å™¨\nå®‰è£… centos uname -r yum update yum makecache fast yum install docker-ce docker version systemctl status docker systemctl start docker // æµ‹è¯• docker pull hello-world docker run hello-world Ubuntu curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun å¸¸ç”¨å‘½ä»¤ https://www.bilibili.com/video/BV1gr4y1U7CY?p=18\u0026spm_id_from=pageDriver\u0026vd_source=6168fe2db91f9a8c4c41d41f39d1703e\nå¯åŠ¨docker:\tsystemctl start docker åœæ­¢docker:\tsystemctl stop docker é‡å¯docker:\tsystemctl restart docker æŸ¥çœ‹dockerçŠ¶æ€:\tsystemctl status docker å¼€æœºå¯åŠ¨:\tsystemctl enable docker æŸ¥çœ‹dockeræ¦‚è¦ä¿¡æ¯:\tdocker info æŸ¥çœ‹docker æ€»ä½“å¸®åŠ©æ–‡æ¡£:\tdocker-help æŸ¥çœ‹docker å‘½ä»¤å¸®åŠ©æ–‡æ¡£:\tdockerå…·ä½“å‘½ä»¤-help docker ä¸­å¤®ä»“åº“ å­˜æ”¾é•œåƒçš„ç½‘ç«™\nå®˜ç½‘ï¼šhttps://hub.docker.com/\ndaocloudï¼šhttp://hub.daocloud.io/\ndocker é•œåƒæ“ä½œ æ‹‰å–åˆ°æœ¬åœ° docker pull daocloud.io/library/tomcat:8.0.45 æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰é•œåƒ docker images åˆ é™¤ // æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„ docker ps -a docker rm a66 docker rmi é•œåƒæ ‡è¯† é•œåƒå¯¼å‡ºå¯¼å…¥ docker save -o è·¯å¾„ é•œåƒid\u003cå‰ä¸¤ä½å³å¯\u003e docker load -i é•œåƒæ–‡ä»¶ ä¿®æ”¹é•œåƒåç§° docker tag é•œåƒid æ–°é•œåƒåç§°:ç‰ˆæœ¬ docker tag fa tomcat:8.0 docker å®¹å™¨æ“ä½œ 1ã€è¿è¡Œå®¹å™¨ åŸºæœ¬æ“ä½œ\ndocker run é•œåƒçš„æ ‡è¯†é•œåƒåç§°[:tag] å¸¸ç”¨çš„å‚æ•°\ndocker run -d -p å®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ --name å®¹å™¨åç§° é•œåƒçš„æ ‡è¯†é•œåƒåç§°[:tag] docker run -d -p 8080:8080 --name tomcat fa è·‘èµ·æ¥åç›´æ¥è®¿é—®å³å¯ -d: ä»£è¡¨åå°è¿è¡Œå®¹å™¨ -p å®¿ä¸»æœºç«¯å£ï¼šå®¹å™¨ç«¯å£ï¼šä¸ºäº†æ˜ å°„å½“å‰Liuxçš„ç«¯å£å’Œå®¹å™¨çš„ç«¯å£ â€“name å®¹å™¨åç§°ï¼šæŒ‡å®šå®¹å™¨çš„åç§° 2ã€æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨ docker ps [-qa] -aï¼šæŸ¥çœ‹å…¨éƒ¨çš„å®¹å™¨ï¼ŒåŒ…æ‹¬æ²¡æœ‰è¿è¡Œ -qï¼šåªæŸ¥çœ‹å®¹å™¨å¾—åˆ°æ ‡è¯† 3ã€æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿— docker logs -f å®¹å™¨id [root@localhost linbin]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS b01afd80c224 fa \"catalina.sh run\" 5 minutes ago Up 5 minutes [root@localhost linbin]# docker logs -f b0 08-Sep-2022 00:49:48.918 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version: Apache Tomcat/8.0.45 08-Sep-2022 00:49:48.921 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server built: Jun 26 2017 20:06:07 UTC 8.0.45.0 08-Sep-2022 00:49:48.921 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Name: Linux 4ã€è¿›å…¥åˆ°å®¹å™¨å†…éƒ¨ docker exec -it å®¹å™¨id bash [root@localhost linbin]# docker exec -it b0 bash root@b01afd80c224:/usr/local/tomcat# pwd /usr/local/tomcat root@b01afd80c224:/usr/local/tomcat# ls LICENSE NOTICE RELEASE-NOTES\tRUNNING.txt bin conf\tinclude lib logs native-jni-lib temp webapps work root@b01afd80c224:/usr/local/tomcat# cd webapps root@b01afd80c224:/usr/local/tomcat/webapps# ls ROOT docs examples host-manager manager root@b01afd80c224:/usr/local/tomcat/webapps# exit exit 5ã€åˆ é™¤å®¹å™¨ (åˆ é™¤å®¹å™¨å‰ï¼Œéœ€è¦å…ˆåœæ­¢å®¹å™¨)\n#åœæ­¢æŒ‡å®šçš„å®¹å™¨ docker stop å®¹å™¨id #åœæ­¢å…¨éƒ¨å®¹å™¨ docker stop $(docker ps -qa) #åˆ é™¤æŒ‡å®šå®¹å™¨ docker rm å®¹å™¨id #åˆ é™¤å…¨éƒ¨å®¹å™¨ docker rm $(docker ps -qa) #å¯åŠ¨å®¹å™¨ docker start å®¹å™¨id åˆ›å»º mysql å®¹å™¨ åˆ›å»ºMySQLé•œåƒ\ndocker pull daocloud.io/library/mysq1:5.7.5-m15 æŸ¥çœ‹MySQLé•œåƒ\ndocker images åˆ›å»ºMySQLå®¹å™¨\ndocker run -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=root --name msyql é•œåƒtag egï¼š docker run -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=Admin666 --name mysql 644 ç„¶åä½¿ç”¨è¿æ¥å·¥å…· Navicat æµ‹è¯•ã€‚\nå‘1â€“ä¸­æ–‡å­—ç¬¦ æŸ¥çœ‹é‡Œé¢çš„å­—ç¬¦é›†ï¼Œå¥½å®¶ä¼™ï¼ŒLatin1\nmysql\u003e SHOW VARIABLES LIKE 'character%'; +--------------------------+----------------------------+ | Variable_name | Value | +--------------------------+----------------------------+ | character_set_client | latin1 | | character_set_connection | latin1 | | character_set_database | utf8 | | character_set_filesystem | binary | | character_set_results | latin1 | | character_set_server | latin1 | | character_set_system | utf8 | | character_sets_dir | /usr/share/mysql/charsets/ | +--------------------------+----------------------------+ 8 rows in set (0.00 sec) å…³é”®ç‚¹2â€“å¼€å¯æ•°æ®å· åˆ é™¤å®¹å™¨åï¼Œé‡Œé¢çš„mysqlæ•°æ®å¦‚ä½•åŠ å®¹å™¨å®ä¾‹ä¸€åˆ é™¤ï¼Œå•¥æ•°æ®ä¹Ÿæ²¡äº†ï¼\nè§£å†³åŠæ³• 1ã€æ–°å¢æ•°æ®å·\ndocker run -d -p 3306:3306 --privileged=true -v /zzyyuse/mysql/log:/var/log/mysql -v /zzyyuse/mysql/data:/var/lib/mysql -v /zzyyuse/mysql/conf:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=123456 --name mysql mysql:5.7 2ã€/zzyyuse/mysql/conf ä¸‹æ–°å¢ my.cnf\n[client] default_character_set=utf8 [mysqld] collation_server = utf8_general_ci character_set_server = utf8 ç„¶årestartä¸€ä¸‹\nä¹‹å‰çš„DB æ— æ•ˆ\nä¿®æ”¹å­—ç¬¦é›†æ“ä½œ+é‡å¯mysqlå®¹å™¨å®ä¾‹\nä¹‹åçš„DB æœ‰æ•ˆï¼Œéœ€è¦æ–°å»º\nç»“è®ºï¼šdockerå®‰è£…å®ŒMySQLå¹¶runå‡ºå®¹å™¨åï¼Œå»ºè®®è¯·å…ˆä¿®æ”¹å®Œå­—ç¬¦é›†ç¼–ç åå†æ–°å»ºmysqlåº“-è¡¨-æ’æ•°æ®\nå°†é¡¹ç›®éƒ¨ç½²åˆ°Tomcat ä¸Šä¼ é¡¹ç›® ä¸Šä¼ é¡¹ç›®\nè¿›å…¥å®¹å™¨ç›®å½• docker exec -it å®¹å™¨tag bash\nå°†é¡¹ç›®æ‹·è´åˆ°tomcat:å®¹å™¨çš„webappsç›®å½•ä¸‹é¢ docker cp demo a17:/usr/local/tomcat/webapps\næŸ¥çœ‹tomcatè¿è¡Œæ—¥å¿— docker logs -f å®¹å™¨tag\ndocker æ•°æ®å· ä¸ºäº†éƒ¨ç½²æˆ‘ä»¬çš„demoå·¥ç¨‹ï¼Œéœ€è¦ä½¿ç”¨åˆ° cp çš„å‘½ä»¤å°†å®¿ä¸»æœºå†…çš„ demoæ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨å†…éƒ¨\næ•°æ®å·ï¼šå°†å®¿ä¸»æœºçš„ä¸€ä¸ªç›®å½•ï¼Œæ˜ å°„åˆ°å®¹å™¨çš„ä¸€ä¸ªç›®å½•ä¸­ï¼Œå¯ä»¥åœ¨å®¿ä¸»æœºä¸­æ“ä½œç›®å½•ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆå®¹å™¨å†…éƒ¨æ˜ å°„çš„æ–‡ä»¶ï¼Œä¹Ÿä¼šè·Ÿç€ä¸€èµ·æ”¹å˜ã€‚\nåœ¨æŒ‚è½½ç›®å½•åå¤šåŠ ä¸€ä¸ªå‚æ•° --privileged=true\n1.åˆ›å»ºæ•°æ®å· docker volume create æ•°æ®å·åç§° #åˆ›å»ºæ•°æ®å·ä¹‹åï¼Œé»˜è®¤ä¼šå­˜æ”¾åœ¨ä¸€ä¸ªç›®å½•ä¸‹/var/Tb/docker/volumes./æ•°æ®å·åç§°/_data 2.æŸ¥çœ‹æ•°æ®å·çš„è¯¦ç»†ä¿¡æ¯ docker volume inspect æ•°æ®å·åç§° 3.æŸ¥çœ‹å…¨éƒ¨æ•°æ®å· docker volume ls 4.åˆ é™¤æ•°æ®å· docker volume rm æ•°æ®å·åç§° 5.åº”ç”¨æ•°æ®å· å½“ä½ æ˜ å°„æ•°æ®å·æ—¶ï¼Œå¦‚æœæ•°æ®å·ä¸å­˜åœ¨ã€‚Dockerä¼šå¸®ä½ è‡ªåŠ¨åˆ›å»ºï¼Œä¼šå°†å®¹å™¨å†…éƒ¨è‡ªå¸¦çš„æ–‡ä»¶ï¼Œå­˜å‚¨åœ¨é»˜è®¤çš„å­˜æ”¾è·¯å¾„ä¸­ã€‚\ndocker run -v æ•°æ®å·åç§°:å®¹å™¨å†…éƒ¨çš„è·¯å¾„é•œåƒid #ç›´æ¥æŒ‡å®šä¸€ä¸ªè·¯å¾„ä½œä¸ºæ•°æ®å·çš„å­˜æ”¾ä½ç½®ã€‚è¿™ä¸ªè·¯å¾„ä¸‹æ˜¯ç©ºçš„ã€‚ docker run -V å®¿ä¸»æœºè·¯å¾„:å®¹å™¨å†…éƒ¨çš„è·¯å¾„ é•œåƒid docker run -d -p 8080:8080 -v /home/tomcat_webapps:/usr/local/tomcat/webapps/ --name tomcat fa6 æµ‹è¯• docker run -d --privileged=true -v /tmp/host_data/:/tmp/docker_data/ --name u1 ubuntu [root@iZwz982ksp86xdjeeirtsdZ tmp]# cd /tmp/host_data/ [root@iZwz982ksp86xdjeeirtsdZ host_data]# touch test.txt [root@iZwz982ksp86xdjeeirtsdZ host_data]# ls test.txt [root@iZwz982ksp86xdjeeirtsdZ host_data]# docker exec -it afb bash root@afb5e67ee3d4:/# cd /tmp/docker_data/ root@afb5e67ee3d4:/tmp/docker_data# ls test.txt root@afb5e67ee3d4:/tmp/docker_data# æŸ¥çœ‹æ˜¯å¦æŒ‚è½½æˆåŠŸ\n[root@iZwz982ksp86xdjeeirtsdZ host_data]# docker inspect af \"Mounts\": [ { \"Type\": \"bind\", \"Source\": \"/tmp/host_data\", \"Destination\": \"/tmp/docker_data\", \"Mode\": \"\", \"RW\": true, \"Propagation\": \"rprivate\" } ], å¦‚æœ docker stop äº†ï¼Œç„¶ååœ¨å®¿ä¸»æœºç»‘å®šçš„ç›®å½•æ–°å¢äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶ååœ¨ start ä¸€ä¸‹ï¼Œå‘ç°ä¼šåŒæ­¥è¿‡æ¥ã€‚\næ˜¯å…±äº«çš„æ„æ€ã€‚\nåªè¯» ä¸Šé¢é»˜è®¤rw\ndocker run -it -privileged=true -v /å®¿ä¸»æœºç»å¯¹è·¯å¾„ç›®å½•:/å®¹å™¨å†…ç›®å½•:ro é•œåƒå /å®¹å™¨ç›®å½•:ro é•œåƒå å°±èƒ½å®ŒæˆåŠŸèƒ½ï¼Œæ­¤æ—¶å®¹å™¨è‡ªå·±åªèƒ½è¯»å–ä¸èƒ½å†™\nro = read only\næ­¤æ—¶å¦‚æœå®¿ä¸»æœºå†™å…¥å†…å®¹ï¼Œå¯ä»¥åŒæ­¥ç»™å®¹å™¨å†…ï¼Œå®¹å™¨å¯ä»¥è¯»å–åˆ°ã€‚\nç»§æ‰¿ å®¹å™¨1å®Œæˆå’Œå®¿ä¸»æœºçš„æ˜ å°„ å®¹å™¨2ç»§æ‰¿å®¹å™¨1çš„å·è§„åˆ™ ä¸€\ndocker run -it --privileged=true --volumes-from çˆ¶äº² --name u2 ubuntu Dockerfile ä»€ä¹ˆæ˜¯Dockerfile? DockerFileè¯¦è§£\nDockerfileæ˜¯ä¸€ä¸ªåŒ…å«ç”¨äºç»„åˆæ˜ åƒçš„å‘½ä»¤çš„æ–‡æœ¬æ–‡æ¡£ã€‚å¯ä»¥ä½¿ç”¨åœ¨å‘½ä»¤è¡Œä¸­è°ƒç”¨çš„ä»»ä½•å‘½ä»¤ã€‚\nDockeré€šè¿‡è¯»å–Dockerfileä¸­çš„æŒ‡ä»¤è‡ªåŠ¨ç”Ÿæˆæ˜ åƒã€‚\ndocker build å‘½ä»¤ç”¨äºä» Dockerfile æ„å»ºæ˜ åƒã€‚\nå¯ä»¥åœ¨docker buiIdå‘½ä»¤ä¸­ä½¿ç”¨-fæ ‡å¿—æŒ‡å‘æ–‡ä»¶ç³»ç»Ÿä¸­ä»»ä½•ä½ç½®çš„Dockerfileã€‚\nä¾‹ï¼š\ndocker build -f /path/to/a/Dockerfile Dockerfileçš„åŸºæœ¬ç»“æ„ Dockerfileä¸€èˆ¬åˆ†ä¸ºå››éƒ¨åˆ†ï¼š\n1.åŸºç¡€é•œåƒä¿¡æ¯\n2.ç»´æŠ¤è€…ä¿¡æ¯\n3.é•œåƒæ“ä½œæŒ‡ä»¤\n4.å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡ŒæŒ‡ä»¤\nDockerfileæ–‡ä»¶è¯´æ˜ Dockerä»¥ä»ä¸Šåˆ°ä¸‹çš„é¡ºåºè¿è¡Œ Dockerfile çš„æŒ‡ä»¤ã€‚ä¸ºäº†æŒ‡å®šåŸºæœ¬æ˜ åƒï¼Œç¬¬ä¸€æ¡æŒ‡ä»¤å¿…é¡»æ˜¯FROMã€‚ä¸€ä¸ªå£°æ˜ä»¥#å­—ç¬¦å¼€å¤´åˆ™è¢«è§†ä¸ºæ³¨é‡Šã€‚å¯ä»¥åœ¨Dockeræ–‡ä»¶ä¸­ä½¿ç”¨RUN,CMD,FROM,EXPOSE,ENVç­‰æŒ‡ä»¤ã€‚\nåœ¨è¿™é‡Œåˆ—å‡ºäº†ä¸€äº›å ‚ç”¨çš„æŒ‡ä»¤.\næŒ‡ä»¤ FROM æŒ‡å®šåŸºç¡€é•œåƒï¼Œå¿…é¡»ä¸ºç¬¬ä¸€ä¸ªå‘½ä»¤\næ ¼å¼ï¼š FROM FROM : FROM @ ç¤ºä¾‹ï¼š FROM mysq1:5.6 æ³¨ï¼štagæˆ–digestæ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¸ä½¿ç”¨è¿™ä¸¤ä¸ªå€¼æ—¶ï¼Œä¼šä½¿ç”¨jlatestç‰ˆæœ¬çš„åŸºç¡€é•œåƒ\nMAINTAINER ç»´æŠ¤è€…ä¿¡æ¯\næ ¼å¼ï¼š MAINTAINER ç¤ºä¾‹ï¼š MAINTAINER Jasper Xu MAINTAINER sorex@163.com MAINTAINER Jasper Xu RUN æ„å»ºé•œåƒæ—¶æ‰§è¡Œçš„å‘½ä»¤\nRUNç”¨äºåœ¨é•œåƒå®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤ï¼Œå…¶æœ‰ä»¥ä¸‹ä¸¤ç§å‘½ä»¤æ‰§è¡Œæ–¹å¼ï¼š shellæ‰§è¡Œ æ ¼å¼ï¼š RUN execæ‰§è¡Œ æ ¼å¼ï¼š RUN [\"executable\",\"paraml\",\"param2\"] ç¤ºä¾‹ï¼š RUN [\"executable\",\"param1\",\"param2\"] RUN apk update RUN [\"/etc/execfile\",\"arg1\",\"arg1\"] æ³¨ï¼šRUNæŒ‡ä»¤åˆ›å»ºçš„ä¸­é—´é•œåƒä¼šè¢«ç¼“å­˜ï¼Œå¹¶ä¼šåœ¨ä¸‹æ¬¡æ„å»ºä¸­ä½¿ç”¨ã€‚å¦‚æœä¸æƒ³ä½¿ç”¨è¿™äº›ç¼“å­˜é•œåƒï¼Œå¯ä»¥åœ¨æ„å»ºæ—¶æŒ‡å®šâ€“no-cacheå‚æ•°ï¼Œå¦‚ï¼šdocker build â€“no-cache\nADD ADD æŒ‡ä»¤å’Œ COPY çš„ä½¿ç”¨æ ¼ç±»ä¼¼ï¼ˆåŒæ ·éœ€æ±‚ä¸‹ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ COPYï¼‰ã€‚åŠŸèƒ½ä¹Ÿç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„å¦‚ä¸‹ï¼š\nADD çš„ä¼˜ç‚¹ï¼šåœ¨æ‰§è¡Œ \u003cæºæ–‡ä»¶\u003e ä¸º tar å‹ç¼©æ–‡ä»¶çš„è¯ï¼Œå‹ç¼©æ ¼å¼ä¸º gzip, bzip2 ä»¥åŠ xz çš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨å¤åˆ¶å¹¶è§£å‹åˆ° \u003cç›®æ ‡è·¯å¾„\u003eã€‚ ADD çš„ç¼ºç‚¹ï¼šåœ¨ä¸è§£å‹çš„å‰æä¸‹ï¼Œæ— æ³•å¤åˆ¶ tar å‹ç¼©æ–‡ä»¶ã€‚ä¼šä»¤é•œåƒæ„å»ºç¼“å­˜å¤±æ•ˆï¼Œä»è€Œå¯èƒ½ä¼šä»¤é•œåƒæ„å»ºå˜å¾—æ¯”è¾ƒç¼“æ…¢ã€‚å…·ä½“æ˜¯å¦ä½¿ç”¨ï¼Œå¯ä»¥æ ¹æ®æ˜¯å¦éœ€è¦è‡ªåŠ¨è§£å‹æ¥å†³å®šã€‚ æ ¼å¼ï¼š ADD \u003csrc\u003e...\u003cdest\u003e ADD[\"\",...\"\" ç”¨äºæ”¯æŒåŒ…å«ç©ºæ ¼çš„è·¯å¾„ ç¤ºä¾‹ï¼š ADD hom* /mydir/\t#æ·»åŠ æ‰€æœ‰ä»¥\"hom\"å¼€å¤´çš„æ–‡ä»¶ ADD hom?.txt /mydir/\t#?æ›¿ä»£ä¸€ä¸ªå•å­—ç¬¦ï¼Œä¾‹å¦‚ï¼š\"home.txt\" ADD test relativeDir/\t#æ·»åŠ \"test\"åˆ°`WORKDIR`/relativeDir/ ADD test /absoluteDir/\t#æ·»åŠ \"test\"åˆ°/absoluteDir/ CMD ç±»ä¼¼äº RUN æŒ‡ä»¤ï¼Œç”¨äºè¿è¡Œç¨‹åºï¼Œä½†äºŒè€…è¿è¡Œçš„æ—¶é—´ç‚¹ä¸åŒ:\nCMD åœ¨docker run æ—¶è¿è¡Œã€‚ RUN æ˜¯åœ¨ docker buildã€‚ ä½œç”¨ï¼šä¸ºå¯åŠ¨çš„å®¹å™¨æŒ‡å®šé»˜è®¤è¦è¿è¡Œçš„ç¨‹åºï¼Œç¨‹åºè¿è¡Œç»“æŸï¼Œå®¹å™¨ä¹Ÿå°±ç»“æŸã€‚CMD æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºå¯è¢« docker run å‘½ä»¤è¡Œå‚æ•°ä¸­æŒ‡å®šè¦è¿è¡Œçš„ç¨‹åºæ‰€è¦†ç›–ã€‚\næ³¨æ„ï¼šå¦‚æœ Dockerfile ä¸­å¦‚æœå­˜åœ¨å¤šä¸ª CMD æŒ‡ä»¤ï¼Œä»…æœ€åä¸€ä¸ªç”Ÿæ•ˆã€‚\næ ¼å¼ï¼š\nCMD CMD [\"\u003cå¯æ‰§è¡Œæ–‡ä»¶æˆ–å‘½ä»¤\u003e\",\"\",\"\",...] CMD [\"\",\"\",...] # è¯¥å†™æ³•æ˜¯ä¸º ENTRYPOINT æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºæä¾›é»˜è®¤å‚æ•° æ¨èä½¿ç”¨ç¬¬äºŒç§æ ¼å¼ï¼Œæ‰§è¡Œè¿‡ç¨‹æ¯”è¾ƒæ˜ç¡®ã€‚ç¬¬ä¸€ç§æ ¼å¼å®é™…ä¸Šåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šè‡ªåŠ¨è½¬æ¢æˆç¬¬äºŒç§æ ¼å¼è¿è¡Œï¼Œå¹¶ä¸”é»˜è®¤å¯æ‰§è¡Œæ–‡ä»¶æ˜¯ shã€‚\nCOPY å¤åˆ¶æŒ‡ä»¤ï¼Œä»ä¸Šä¸‹æ–‡ç›®å½•ä¸­å¤åˆ¶æ–‡ä»¶æˆ–è€…ç›®å½•åˆ°å®¹å™¨é‡ŒæŒ‡å®šè·¯å¾„ã€‚\næ ¼å¼ï¼š\nCOPY [--chown=:] \u003cæºè·¯å¾„1\u003e... \u003cç›®æ ‡è·¯å¾„\u003e COPY [--chown=:] [\"\u003cæºè·¯å¾„1\u003e\",... \"\u003cç›®æ ‡è·¯å¾„\u003e\"] [â€“chown=:]ï¼šå¯é€‰å‚æ•°ï¼Œç”¨æˆ·æ”¹å˜å¤åˆ¶åˆ°å®¹å™¨å†…æ–‡ä»¶çš„æ‹¥æœ‰è€…å’Œå±ç»„ã€‚\n\u003cæºè·¯å¾„\u003eï¼šæºæ–‡ä»¶æˆ–è€…æºç›®å½•ï¼Œè¿™é‡Œå¯ä»¥æ˜¯é€šé…ç¬¦è¡¨è¾¾å¼ï¼Œå…¶é€šé…ç¬¦è§„åˆ™è¦æ»¡è¶³ Go çš„ filepath.Match è§„åˆ™ã€‚ä¾‹å¦‚ï¼š\nCOPY hom* /mydir/ COPY hom?.txt /mydir/ \u003cç›®æ ‡è·¯å¾„\u003eï¼šå®¹å™¨å†…çš„æŒ‡å®šè·¯å¾„ï¼Œè¯¥è·¯å¾„ä¸ç”¨äº‹å…ˆå»ºå¥½ï¼Œè·¯å¾„ä¸å­˜åœ¨çš„è¯ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºã€‚\nFROM centos # æ·»åŠ æ–‡ä»¶åˆ°ç›®å½•ä¸‹ COPY test.txt /mydir/ # å°†æ–‡ä»¶å†…å®¹å†™å…¥ mytest COPY test.txt /mytest # å‹ç¼©æ–‡ä»¶,è‡ªåŠ¨è§£å‹ COPY jmeter.log.zip /myzipdir/ # æ·»åŠ ç›®å½• COPY TeamFile / # å…¶ä»–æ–‡ä»¶ COPY jmeter.log /mydir/ # å¤šä¸ªæ–‡ä»¶ COPY test1.txt test2.txt /mydir/ # é€šé…ç¬¦,dest ä¸å­˜åœ¨è‡ªåŠ¨åˆ›å»º COPY test*.txt /mydir/test/ # ç‰¹æ®Šå­—ç¬¦ä¸² COPY COPY[[]0].txt /mydir/ WORKDIR /data # ç›¸å¯¹è·¯å¾„ COPY test.txt test/ VOLUME å®šä¹‰åŒ¿åæ•°æ®å·ã€‚åœ¨å¯åŠ¨å®¹å™¨æ—¶å¿˜è®°æŒ‚è½½æ•°æ®å·ï¼Œä¼šè‡ªåŠ¨æŒ‚è½½åˆ°åŒ¿åå·ã€‚\nä½œç”¨ï¼š\né¿å…é‡è¦çš„æ•°æ®ï¼Œå› å®¹å™¨é‡å¯è€Œä¸¢å¤±ï¼Œè¿™æ˜¯éå¸¸è‡´å‘½çš„ã€‚ é¿å…å®¹å™¨ä¸æ–­å˜å¤§ã€‚ æ ¼å¼ï¼š\nVOLUME [\"\u003cè·¯å¾„1\u003e\", \"\u003cè·¯å¾„2\u003e\"...] VOLUME \u003cè·¯å¾„\u003e å°š docker è‡ªå®šä¹‰é•œåƒ è‡ªå®šä¹‰é•œåƒ\ndocker-compose éœ€æ±‚\nä¹‹å‰è¿è¡Œä¸€ä¸ªé•œåƒï¼Œéœ€è¦æ·»åŠ å¤§é‡çš„å‚æ•°ã€‚\nå¯ä»¥é€šè¿‡Docker-Composeç¼–å†™è¿™äº›å‚æ•°ã€‚\nDocker-Composeå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ‰¹é‡çš„ç®¡ç†å®¹å™¨ã€‚\nåªéœ€è¦é€šè¿‡ä¸€ä¸ªdocker-compose.ymlæ–‡ä»¶å»ç»´æŠ¤å³å¯ã€‚\nä¸‹è½½å®‰è£…\n1.å»githubå®˜ç½‘æœç´¢docker-compose,ä¸‹è½½Docker-Compose\ndocker-compose-Linux-x86_64\n2.å°†ä¸‹è½½å¥½çš„æ–‡ä»¶ï¼Œæ‹–æ‹½åˆ°Liuxæ“ä½œç³»ç»Ÿä¸­\n3.éœ€è¦å°†DockerComposeæ–‡ä»¶çš„åç§°ä¿®æ”¹ä¸€ä¸‹ï¼ŒåŸºäºDockerComposeæ–‡ä»¶ä¸€ä¸ªå¯æ‰§è¡Œçš„æƒé™\n[root@localhost compose]# mv docker-compose-linux-x86_64 docker-compose [root@localhost compose]# mv docker-compose /usr/local/bin //æ”¾åˆ°è·¯å¾„ä¸­ [root@localhost compose]# cd /usr/local/bin [root@localhost bin]# ls docker-compose [root@localhost bin]# chmod 777 docker-compose //å¯æ‰§è¡Œæƒé™ [root@localhost bin]# ls -al total 3000 drwxr-xr-x. 2 root root 28 Sep 7 23:23 . drwxr-xr-x. 12 root root 131 Aug 14 01:15 .. -rwxrwxrwx. 1 linbin linbin 3072000 Sep 7 23:19 docker-compose [root@localhost bin]# 4.æ–¹ä¾¿åæœŸæ“ä½œï¼Œé…ç½®ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œè®©åœ¨å…¶ä»–ç›®å½•ä¹Ÿå¯ä»¥æ‰§è¡Œ\nvi /etc/profile yml æ–‡ä»¶ Jenkins gitlab Jenkins sh docker stop jenkins \u003e /dev/null 2\u003e /dev/null || : docker container rm jenkins \u003e /dev/null 2\u003e /dev/null || : docker run \\ --name jenkins \\ -d \\ -p 8080:8080 \\ -p 50000:50000 \\ -v jenkins_home:/var/jenkins_home:z \\ --env=\"JENKINS_OPTS=--prefix=/jenkins\" \\ -v deploy:/var/deploy:z \\ --network bridge \\ jenkins:1.0 gitlab sh docker pull gitlab/gitlab-ce:15.4.0-ce.0\ndocker stop gitlab \u003e /dev/null 2\u003e /dev/null || : docker container rm gitlab \u003e /dev/null 2\u003e /dev/null || : docker run -d \\ --name gitlab \\ --hostname my-gitlab \\ --publish 19080:80 --publish 19022:22 \\ --restart always \\ --volume /gitLabs/config:/etc/gitlab:Z \\ --volume /gitLabs/logs:/var/log/gitlab:Z \\ --volume /gitLabs/data:/var/opt/gitlab:Z \\ gitlab/gitlab-ce:15.4.0-ce.0 https://www.cnblogs.com/diaomina/p/12830449.html\nä¿®æ”¹ hostname\nvi /opt/gitlab/embedded/service/gitlab-rails/config/gitlab.yml Windows ç¼–è¯‘åéƒ¨ç½² [juejin] server windows ç¼–è¯‘\n// æ³¨æ„ --\u003e ä½¿ç”¨ cmd è€Œä¸æ˜¯ powershell SET GOOS=linux SET GOARCH=amd64 go build ./main.go å°†ç¼–è¯‘å½¢æˆçš„äºŒè¿›åˆ¶æ–‡ä»¶\ndockerfile\nFROM alpine:latest RUN mkdir \"/app\" RUN mkdir \"/app/config\" WORKDIR \"/app\" COPY main /app/ COPY config.ini /app/config/ ENTRYPOINT [\"./main\"] åœ¨ Linux ä¸‹çš„ docker æ‰“åŒ…æ„å»ºé•œåƒ\nsudo docker image build --platform linux/amd64 -t juejin_blog:v2.2 . docker image ls sudo docker run -it -p 9000:9000 juejin_blog:v2.2 nginx docker pull nginx ;æ–°å»ºç›®å½•ç»“æ„ï¼šnginxæ–‡ä»¶å¤¹ä¸‹æ–°å»ºconf.dæ–‡ä»¶å¤¹ï¼Œhtmlæ–‡ä»¶å¤¹ /docker |---juejin |----nginx |----conf.d |----html default.conf\nserver { listen 80; server_name 49.109.50.48; location / { root /usr/share/nginx/html; try_files $uri $uri/ /index.html; index index.html index.htm; } location /api/ { proxy_pass http://49.109.50.48:9000; proxy_redirect default; rewrite ^/api/(.*) /$1 break; } error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } } run.sh\nsudo docker run -d -p 80:80 \\ --name nginx_v1.3 \\ -v /docker/juejin/nginx/conf.d:/etc/nginx/conf.d \\ -v /docker/juejin/nginx/html/dist:/usr/share/nginx/html \\ nginx:latest å…ˆç”¨ builder æ„å»ºå† run [sms] go dockerfile FROM golang:alpine as builder ENV GOPROXY=https://goproxy.cn,direct WORKDIR /home COPY . . RUN go mod tidy RUN go build -o sms main.go FROM alpine as runner ENV WORKDIR=/home WORKDIR $WORKDIR RUN apk add tzdata --no-cache \\ \u0026\u0026 cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\ \u0026\u0026 echo \"Asia/Shanghai\" \u003e /etc/timezone \\ \u0026\u0026 apk del tzdata COPY --from=builder $WORKDIR/sms $WORKDIR CMD [\"./sms\"] nginx dockerfile â””â”€frontend â”œâ”€conf.d â””â”€html â””â”€dist â””â”€assets nginx.conf\nserver { listen 80; server_name 43.139.40.48; location / { root /usr/share/nginx/html; try_files $uri $uri/ /index.html; index index.html index.htm; } location /api/ { proxy_pass http://43.139.40.48:8082; proxy_redirect default; rewrite ^/api/(.*) /$1 break; } error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } } # ä½¿ç”¨ Nginx ä½œä¸ºåŸºç¡€é•œåƒ FROM nginx:alpine # å°†æ„å»ºå¥½çš„å‰ç«¯åº”ç”¨é™æ€æ–‡ä»¶å¤åˆ¶åˆ° Nginx çš„ HTML ç›®å½• COPY ./html /usr/share/nginx/html COPY ./conf.d /etc/nginx/conf.d # æš´éœ²ç«¯å£ï¼Œå¦‚æœéœ€è¦çš„è¯ EXPOSE 80 # Nginx ä¼šè‡ªåŠ¨å¯åŠ¨ï¼Œæ— éœ€æ‰‹åŠ¨å¯åŠ¨ Nginx æœåŠ¡ docker-compose version: '3' services: backend: build: context: ./sms-backend dockerfile: ./Dockerfile image: smsbackend container_name: \"smsbackend_container\" ports: - \"8082:8080\" environment: - PG_USER=postgres - PG_PASSWORD=admin666 - PG_DBNAME=sms - PG_SSLMODE=disable - PG_HOST=43.139.40.48 - PG_PORT=5432 nginx: build: context: ./sms-frontend dockerfile: ./Dockerfile image: nginx:sms container_name: \"smsnginx_container\" ports: - \"17000:80\" - \"443:443\" volumes: - /sms-frontend/conf.d:/etc/nginx/conf.d - /sms-frontend/html:/usr/share/nginx/html restart: always other WSL2 Ubuntu22.04 å®‰è£… Docker ï¼Œå‘ç° daemon å¯åŠ¨å¤±è´¥ root@LAPTOP-O0KBCH8Q:~# service docker start * Starting Docker: docker [ OK ] root@LAPTOP-O0KBCH8Q:~# docker version Client: Docker Engine - Community Version: 20.10.18 API version: 1.41 Go version: go1.18.6 Git commit: b40c2f6 Built: Thu Sep 8 23:11:43 2022 OS/Arch: linux/amd64 Context: default Experimental: true Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running? root@LAPTOP-O0KBCH8Q:~# sudo systemctl enable docker Synchronizing state of docker.service with SysV service script with /lib/systemd/systemd-sysv-install. Executing: /lib/systemd/systemd-sysv-install enable docker root@LAPTOP-O0KBCH8Q:~# /lib/systemd/systemd-sysv-install enable docker root@LAPTOP-O0KBCH8Q:~# dockerd \u0026 failed to start daemon: Error initializing network controller: error obtaining controller instance: unable to add return rule in DOCKER-ISOLATION-STAGE-1 chain: (iptables failed: iptables --wait -A DOCKER-ISOLATION-STAGE-1 -j RETURN: iptables v1.8.7 (nf_tables): RULE_APPEND failed (No such file or directory): rule in chain DOCKER-ISOLATION-STAGE-1 (exit status 4)) [1]+ Exit 1 dockerd root@LAPTOP-O0KBCH8Q:~# iptables -L -t nat # Warning: iptables-legacy tables present, use iptables-legacy to see them Chain PREROUTING (policy ACCEPT) target prot opt source destination Chain INPUT (policy ACCEPT) target prot opt source destination Chain OUTPUT (policy ACCEPT) target prot opt source destination Chain POSTROUTING (policy ACCEPT) target prot opt source destination Chain DOCKER (0 references) target prot opt source destination root@LAPTOP-O0KBCH8Q:~# sudo update-alternatives --config iptables There are 2 choices for the alternative iptables (providing /usr/sbin/iptables). Selection Path Priority Status ------------------------------------------------------------ * 0 /usr/sbin/iptables-nft 20 auto mode 1 /usr/sbin/iptables-legacy 10 manual mode 2 /usr/sbin/iptables-nft 20 manual mode Press to keep the current choice[*], or type selection number: 1 update-alternatives: using /usr/sbin/iptables-legacy to provide /usr/sbin/iptables (iptables) in manual mode root@LAPTOP-O0KBCH8Q:~# service docker start * Starting Docker: docker [ OK ] root@LAPTOP-O0KBCH8Q:~# service docker status * Docker is running root@LAPTOP-O0KBCH8Q:~# docker pull hello-world Using default tag: latest latest: Pulling from library/hello-world 2db29710123e: Pull complete Digest: sha256:62af9efd515a25f84961b70f973a798d2eca956b1b2b026d0a4a63a3b0b6a3f2 Status: Downloaded newer image for hello-world:latest docker.io/library/hello-world:latest root@LAPTOP-O0KBCH8Q:~# docker run hello-world Hello from Docker! This message shows that your installation appears to be working correctly. To generate this message, Docker took the following steps: 1. The Docker client contacted the Docker daemon. 2. The Docker daemon pulled the \"hello-world\" image from the Docker Hub. (amd64) 3. The Docker daemon created a new container from that image which runs the executable that produces the output you are currently reading. 4. The Docker daemon streamed that output to the Docker client, which sent it to your terminal. To try something more ambitious, you can run an Ubuntu container with: $ docker run -it ubuntu bash Share images, automate workflows, and more with a free Docker ID: https://hub.docker.com/ For more examples and ideas, visit: https://docs.docker.com/get-started/ docker: Error response from daemon: network qnear not found. æ”¹æˆ bridge ã€‚\n",
  "wordCount" : "5470",
  "inLanguage": "zh",
  "datePublished": "2023-10-28T18:35:29+08:00",
  "dateModified": "2023-10-28T18:35:29+08:00",
  "author":[{
    "@type": "Person",
    "name": "Blaine"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://Bin-lin-rgb.github.io/posts/deploy/docker/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Blaine's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://Bin-lin-rgb.github.io/img/icon.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    (function () {
        let  arr,reg = new RegExp("(^| )"+"change-themes"+"=([^;]*)(;|$)");
        if(arr = document.cookie.match(reg)) {
        } else {
            if (new Date().getHours() >= 19 || new Date().getHours() < 6) {
                document.body.classList.add('dark');
                localStorage.setItem("pref-theme", 'dark');
            } else {
                document.body.classList.remove('dark');
                localStorage.setItem("pref-theme", 'light');
            }
        }
    })()

    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://Bin-lin-rgb.github.io/" accesskey="h" title="Blaine&#39;s Blog (Alt + H)">
            <img src="https://Bin-lin-rgb.github.io/img/icon.png" alt="logo" aria-label="logo"
                 height="35">Blaine&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://Bin-lin-rgb.github.io/" title="ğŸ  ä¸»é¡µ">
                <span>ğŸ  ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://Bin-lin-rgb.github.io/posts" title="ğŸ“š æ–‡ç« ">
                <span>ğŸ“š æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://Bin-lin-rgb.github.io/search" title="ğŸ” æœç´¢ (Alt &#43; /)" accesskey=/>
                <span>ğŸ” æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://Bin-lin-rgb.github.io/tags" title="ğŸ§© æ ‡ç­¾">
                <span>ğŸ§© æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://Bin-lin-rgb.github.io/archives/" title="â±ï¸ æ—¶é—´è½´">
                <span>â±ï¸ æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://Bin-lin-rgb.github.io/about" title="ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº">
                <span>ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://Bin-lin-rgb.github.io/links" title="ğŸ¤ å‹é“¾">
                <span>ğŸ¤ å‹é“¾</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main page">
<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }
</style>

<article class="post-single">
    <div id="single-content">
        <header class="post-header">
            <div class="breadcrumbs"><a href="https://Bin-lin-rgb.github.io/">ğŸ  ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="https://Bin-lin-rgb.github.io/posts/">ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href="https://Bin-lin-rgb.github.io/posts/deploy/">â¬ Deploy</a></div>
            <h1 class="post-title">
                Docker åŸºç¡€
            </h1>
            <div class="post-meta">

<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>2023-10-28
            &nbsp;&nbsp;
        </span>
    </span>
    
    
    
    
    
    
    
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>5470å­—
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>11åˆ†é’Ÿ
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_5">
        <span class="fa fa-user-o"></span>
        <span>Blaine
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
            <span class="post-tags-meta">
                <a href="https://Bin-lin-rgb.github.io/tags/docker/" style="color: var(--secondary)!important;">docker</a>
            </span>
        </span>
    </span>
</span>
<span style="opacity: 0.8;">
                    <span id="post_meta_style_7">
                        &nbsp;&nbsp;
                        <span class="fa fa-eye" ></span>
                        <span>
                            <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
                            &nbsp;&nbsp;
                        </span>
                    </span>
                    <span id="post_meta_style_8">
                        <span class="fa fa-commenting-o"></span>
                        <span>
                            <script src="https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js"></script>
                            <script>
                                let url = document.documentURI
                                
                                let dnsUrl = "https://Bin-lin-rgb.github.io/"
                                let urlSplit = url.split(dnsUrl)
                                let finalUrl = urlSplit[1]
                                if (finalUrl[0] !== '/') {
                                    finalUrl = '/'+finalUrl
                                }
                                twikoo.getCommentsCount({
                                    envId: "https://twikoo-api-nine-silk.vercel.app/", 
                                region: "ap-guangzhou", 
                                urls: [ 
                                    
                                    finalUrl,
                                ],
                                    includeReply: false 
                                }).then(function (res) {
                                    let count = res[0].count
                                    const obj = document.getElementById("comment_count");
                                    obj.innerText = count
                                    
                                    
                                    
                                }).catch(function (err) {
                                    
                                    console.error(err);
                                });
                            </script>
                            <span id="comment_count"></span>
                        </span>
                    </span>
                </span>

</div>
        </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#docker" aria-label="Docker">Docker</a><ul>
                        
                <li>
                    <a href="#docker%e8%83%bd%e8%a7%a3%e5%86%b3%e7%9a%84%e9%97%ae%e9%a2%98" aria-label="Dockerèƒ½è§£å†³çš„é—®é¢˜">Dockerèƒ½è§£å†³çš„é—®é¢˜</a></li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85" aria-label="å®‰è£…">å®‰è£…</a><ul>
                        
                <li>
                    <a href="#centos" aria-label="centos">centos</a></li>
                <li>
                    <a href="#ubuntu" aria-label="Ubuntu">Ubuntu</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4" aria-label="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤</a></li>
                <li>
                    <a href="#docker-%e4%b8%ad%e5%a4%ae%e4%bb%93%e5%ba%93" aria-label="docker ä¸­å¤®ä»“åº“">docker ä¸­å¤®ä»“åº“</a></li>
                <li>
                    <a href="#docker-%e9%95%9c%e5%83%8f%e6%93%8d%e4%bd%9c" aria-label="docker é•œåƒæ“ä½œ">docker é•œåƒæ“ä½œ</a><ul>
                        
                <li>
                    <a href="#%e6%8b%89%e5%8f%96%e5%88%b0%e6%9c%ac%e5%9c%b0" aria-label="æ‹‰å–åˆ°æœ¬åœ°">æ‹‰å–åˆ°æœ¬åœ°</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e6%9c%ac%e5%9c%b0%e6%89%80%e6%9c%89%e9%95%9c%e5%83%8f" aria-label="æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰é•œåƒ">æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰é•œåƒ</a></li>
                <li>
                    <a href="#%e5%88%a0%e9%99%a4" aria-label="åˆ é™¤">åˆ é™¤</a></li>
                <li>
                    <a href="#%e9%95%9c%e5%83%8f%e5%af%bc%e5%87%ba%e5%af%bc%e5%85%a5" aria-label="é•œåƒå¯¼å‡ºå¯¼å…¥">é•œåƒå¯¼å‡ºå¯¼å…¥</a></li>
                <li>
                    <a href="#%e4%bf%ae%e6%94%b9%e9%95%9c%e5%83%8f%e5%90%8d%e7%a7%b0" aria-label="ä¿®æ”¹é•œåƒåç§°">ä¿®æ”¹é•œåƒåç§°</a></li></ul>
                </li>
                <li>
                    <a href="#docker-%e5%ae%b9%e5%99%a8%e6%93%8d%e4%bd%9c" aria-label="docker å®¹å™¨æ“ä½œ">docker å®¹å™¨æ“ä½œ</a><ul>
                        
                <li>
                    <a href="#1%e8%bf%90%e8%a1%8c%e5%ae%b9%e5%99%a8" aria-label="1ã€è¿è¡Œå®¹å™¨">1ã€è¿è¡Œå®¹å™¨</a></li>
                <li>
                    <a href="#2%e6%9f%a5%e7%9c%8b%e6%ad%a3%e5%9c%a8%e8%bf%90%e8%a1%8c%e7%9a%84%e5%ae%b9%e5%99%a8" aria-label="2ã€æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨">2ã€æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨</a></li>
                <li>
                    <a href="#3%e6%9f%a5%e7%9c%8b%e5%ae%b9%e5%99%a8%e7%9a%84%e6%97%a5%e5%bf%97" aria-label="3ã€æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿—">3ã€æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿—</a></li>
                <li>
                    <a href="#4%e8%bf%9b%e5%85%a5%e5%88%b0%e5%ae%b9%e5%99%a8%e5%86%85%e9%83%a8" aria-label="4ã€è¿›å…¥åˆ°å®¹å™¨å†…éƒ¨">4ã€è¿›å…¥åˆ°å®¹å™¨å†…éƒ¨</a></li>
                <li>
                    <a href="#5%e5%88%a0%e9%99%a4%e5%ae%b9%e5%99%a8" aria-label="5ã€åˆ é™¤å®¹å™¨">5ã€åˆ é™¤å®¹å™¨</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%88%9b%e5%bb%ba-mysql-%e5%ae%b9%e5%99%a8" aria-label="åˆ›å»º mysql å®¹å™¨">åˆ›å»º mysql å®¹å™¨</a><ul>
                        
                <li>
                    <a href="#%e5%9d%911--%e4%b8%ad%e6%96%87%e5%ad%97%e7%ac%a6" aria-label="å‘1&amp;ndash;ä¸­æ–‡å­—ç¬¦">å‘1&ndash;ä¸­æ–‡å­—ç¬¦</a></li>
                <li>
                    <a href="#%e5%85%b3%e9%94%ae%e7%82%b92--%e5%bc%80%e5%90%af%e6%95%b0%e6%8d%ae%e5%8d%b7" aria-label="å…³é”®ç‚¹2&amp;ndash;å¼€å¯æ•°æ®å·">å…³é”®ç‚¹2&ndash;å¼€å¯æ•°æ®å·</a></li>
                <li>
                    <a href="#%e8%a7%a3%e5%86%b3%e5%8a%9e%e6%b3%95" aria-label="è§£å†³åŠæ³•">è§£å†³åŠæ³•</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%b0%86%e9%a1%b9%e7%9b%ae%e9%83%a8%e7%bd%b2%e5%88%b0tomcat" aria-label="å°†é¡¹ç›®éƒ¨ç½²åˆ°Tomcat">å°†é¡¹ç›®éƒ¨ç½²åˆ°Tomcat</a><ul>
                        
                <li>
                    <a href="#%e4%b8%8a%e4%bc%a0%e9%a1%b9%e7%9b%ae" aria-label="ä¸Šä¼ é¡¹ç›®">ä¸Šä¼ é¡¹ç›®</a></li>
                <li>
                    <a href="#%e8%bf%9b%e5%85%a5%e5%ae%b9%e5%99%a8%e7%9b%ae%e5%bd%95" aria-label="è¿›å…¥å®¹å™¨ç›®å½•">è¿›å…¥å®¹å™¨ç›®å½•</a></li>
                <li>
                    <a href="#%e5%b0%86%e9%a1%b9%e7%9b%ae%e6%8b%b7%e8%b4%9d%e5%88%b0tomcat%e5%ae%b9%e5%99%a8%e7%9a%84webapps%e7%9b%ae%e5%bd%95%e4%b8%8b%e9%9d%a2" aria-label="å°†é¡¹ç›®æ‹·è´åˆ°tomcat:å®¹å™¨çš„webappsç›®å½•ä¸‹é¢">å°†é¡¹ç›®æ‹·è´åˆ°tomcat:å®¹å™¨çš„webappsç›®å½•ä¸‹é¢</a></li>
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8btomcat%e8%bf%90%e8%a1%8c%e6%97%a5%e5%bf%97" aria-label="æŸ¥çœ‹tomcatè¿è¡Œæ—¥å¿—">æŸ¥çœ‹tomcatè¿è¡Œæ—¥å¿—</a></li></ul>
                </li>
                <li>
                    <a href="#docker-%e6%95%b0%e6%8d%ae%e5%8d%b7" aria-label="docker æ•°æ®å·">docker æ•°æ®å·</a><ul>
                        
                <li>
                    <a href="#1%e5%88%9b%e5%bb%ba%e6%95%b0%e6%8d%ae%e5%8d%b7" aria-label="1.åˆ›å»ºæ•°æ®å·">1.åˆ›å»ºæ•°æ®å·</a></li>
                <li>
                    <a href="#2%e6%9f%a5%e7%9c%8b%e6%95%b0%e6%8d%ae%e5%8d%b7%e7%9a%84%e8%af%a6%e7%bb%86%e4%bf%a1%e6%81%af" aria-label="2.æŸ¥çœ‹æ•°æ®å·çš„è¯¦ç»†ä¿¡æ¯">2.æŸ¥çœ‹æ•°æ®å·çš„è¯¦ç»†ä¿¡æ¯</a></li>
                <li>
                    <a href="#3%e6%9f%a5%e7%9c%8b%e5%85%a8%e9%83%a8%e6%95%b0%e6%8d%ae%e5%8d%b7" aria-label="3.æŸ¥çœ‹å…¨éƒ¨æ•°æ®å·">3.æŸ¥çœ‹å…¨éƒ¨æ•°æ®å·</a></li>
                <li>
                    <a href="#4%e5%88%a0%e9%99%a4%e6%95%b0%e6%8d%ae%e5%8d%b7" aria-label="4.åˆ é™¤æ•°æ®å·">4.åˆ é™¤æ•°æ®å·</a></li>
                <li>
                    <a href="#5%e5%ba%94%e7%94%a8%e6%95%b0%e6%8d%ae%e5%8d%b7" aria-label="5.åº”ç”¨æ•°æ®å·">5.åº”ç”¨æ•°æ®å·</a></li>
                <li>
                    <a href="#%e6%b5%8b%e8%af%95" aria-label="æµ‹è¯•">æµ‹è¯•</a></li>
                <li>
                    <a href="#%e5%8f%aa%e8%af%bb" aria-label="åªè¯»">åªè¯»</a></li>
                <li>
                    <a href="#%e7%bb%a7%e6%89%bf" aria-label="ç»§æ‰¿">ç»§æ‰¿</a></li></ul>
                </li>
                <li>
                    <a href="#dockerfile" aria-label="Dockerfile">Dockerfile</a><ul>
                        
                <li>
                    <a href="#%e4%bb%80%e4%b9%88%e6%98%afdockerfile" aria-label="ä»€ä¹ˆæ˜¯Dockerfile?">ä»€ä¹ˆæ˜¯Dockerfile?</a></li>
                <li>
                    <a href="#dockerfile%e7%9a%84%e5%9f%ba%e6%9c%ac%e7%bb%93%e6%9e%84" aria-label="Dockerfileçš„åŸºæœ¬ç»“æ„">Dockerfileçš„åŸºæœ¬ç»“æ„</a></li>
                <li>
                    <a href="#dockerfile%e6%96%87%e4%bb%b6%e8%af%b4%e6%98%8e" aria-label="Dockerfileæ–‡ä»¶è¯´æ˜">Dockerfileæ–‡ä»¶è¯´æ˜</a></li>
                <li>
                    <a href="#%e6%8c%87%e4%bb%a4" aria-label="æŒ‡ä»¤">æŒ‡ä»¤</a><ul>
                        
                <li>
                    <a href="#from" aria-label="FROM">FROM</a></li>
                <li>
                    <a href="#maintainer" aria-label="MAINTAINER">MAINTAINER</a></li>
                <li>
                    <a href="#run" aria-label="RUN">RUN</a></li>
                <li>
                    <a href="#add" aria-label="ADD">ADD</a></li>
                <li>
                    <a href="#cmd" aria-label="CMD">CMD</a></li>
                <li>
                    <a href="#copy" aria-label="COPY">COPY</a></li>
                <li>
                    <a href="#volume" aria-label="VOLUME">VOLUME</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%b0%9a" aria-label="å°š">å°š</a></li></ul>
                </li>
                <li>
                    <a href="#docker-%e8%87%aa%e5%ae%9a%e4%b9%89%e9%95%9c%e5%83%8f" aria-label="docker è‡ªå®šä¹‰é•œåƒ">docker è‡ªå®šä¹‰é•œåƒ</a></li>
                <li>
                    <a href="#docker-compose" aria-label="docker-compose">docker-compose</a></li>
                <li>
                    <a href="#yml-%e6%96%87%e4%bb%b6" aria-label="yml æ–‡ä»¶">yml æ–‡ä»¶</a></li>
                <li>
                    <a href="#jenkins-gitlab" aria-label="Jenkins gitlab">Jenkins gitlab</a><ul>
                        
                <li>
                    <a href="#jenkins-sh" aria-label="Jenkins sh">Jenkins sh</a></li>
                <li>
                    <a href="#gitlab-sh" aria-label="gitlab sh">gitlab sh</a></li></ul>
                </li>
                <li>
                    <a href="#windows-%e7%bc%96%e8%af%91%e5%90%8e%e9%83%a8%e7%bd%b2-juejin" aria-label="Windows ç¼–è¯‘åéƒ¨ç½² [juejin]">Windows ç¼–è¯‘åéƒ¨ç½² [juejin]</a><ul>
                        
                <li>
                    <a href="#server" aria-label="server">server</a></li>
                <li>
                    <a href="#nginx" aria-label="nginx">nginx</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%85%88%e7%94%a8-builder-%e6%9e%84%e5%bb%ba%e5%86%8d-run-sms" aria-label="å…ˆç”¨ builder æ„å»ºå† run [sms]">å…ˆç”¨ builder æ„å»ºå† run [sms]</a><ul>
                        
                <li>
                    <a href="#go-dockerfile" aria-label="go dockerfile">go dockerfile</a></li>
                <li>
                    <a href="#nginx-dockerfile" aria-label="nginx dockerfile">nginx dockerfile</a></li>
                <li>
                    <a href="#docker-compose-1" aria-label="docker-compose">docker-compose</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#other" aria-label="other">other</a><ul>
                        
                <li>
                    <a href="#wsl2-ubuntu2204-%e5%ae%89%e8%a3%85-docker-%e5%8f%91%e7%8e%b0-daemon-%e5%90%af%e5%8a%a8%e5%a4%b1%e8%b4%a5" aria-label="WSL2 Ubuntu22.04 å®‰è£… Docker ï¼Œå‘ç° daemon å¯åŠ¨å¤±è´¥">WSL2 Ubuntu22.04 å®‰è£… Docker ï¼Œå‘ç° daemon å¯åŠ¨å¤±è´¥</a></li>
                <li>
                    <a href="#docker-error-response-from-daemon-network-qnear-not-found" aria-label="docker: Error response from daemon: network qnear not found.">docker: Error response from daemon: network qnear not found.</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        
        activeElement = elements[0];
        const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
        document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
    }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        if (elements) {
            activeElement = Array.from(elements).find((element) => {
                if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                    (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                    return element;
                }
            }) || activeElement

            elements.forEach(element => {
                const id = encodeURI(element.getAttribute('id')).toLowerCase();
                if (element === activeElement){
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
                } else {
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
                }
            })
        }
    }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>
        <div class="post-content"><h1 id="docker">Docker<a hidden class="anchor" aria-hidden="true" href="#docker">#</a></h1>
<p>ä¸ºä»€ä¹ˆä½¿ç”¨Docker</p>
<p>ä¼ä¸šç¯å¢ƒä¸­å­˜åœ¨çš„æŸä¸ªç—›ç‚¹
ä¼ä¸šä½¿ç”¨ä¸€é¡¹æŠ€æœ¯æ˜¯ä¸ºäº†è§£å†³å½“å‰ä¼ä¸šç¯å¢ƒä¸­å­˜åœ¨çš„æŸä¸ªç—›ç‚¹ã€‚</p>
<p>ç›®å‰æ•´ä¸ªè½¯ä»¶è¡Œä¸šå­˜åœ¨ç€ä»¥ä¸‹å‡ ä¸ªç—›ç‚¹ã€‚</p>
<p>1.è½¯ä»¶æ›´æ–°å‘å¸ƒåŠéƒ¨ç½²ä½æ•ˆï¼Œè¿‡ç¨‹çƒ¦çä¸”éœ€è¦äººå·¥ä»‹å…¥ã€‚</p>
<p>2.ç¯å¢ƒä¸€è‡´æ€§éš¾ä»¥ä¿è¯ã€‚</p>
<p>3.ä¸åŒç¯å¢ƒä¹‹é—´è¿ç§»æˆæœ¬å¤ªé«˜ã€‚</p>
<h2 id="dockerèƒ½è§£å†³çš„é—®é¢˜">Dockerèƒ½è§£å†³çš„é—®é¢˜<a hidden class="anchor" aria-hidden="true" href="#dockerèƒ½è§£å†³çš„é—®é¢˜">#</a></h2>
<p>é¦–å…ˆï¼ŒDockerçš„ä½¿ç”¨ååˆ†ç®€å•ï¼Œ</p>
<p>ä»å¼€å‘çš„è§’åº¦æ¥çœ‹å°±æ˜¯â€œä¸‰æ­¥èµ°&quot;ï¼šæ„å»ºã€è¿è¾“ã€è¿è¡Œã€‚</p>
<p>å…¶ä¸­ï¼Œå…³é”®æ­¥éª¤æ˜¯æ„å»ºç¯èŠ‚ï¼Œå³æ‰“åŒ…é•œåƒæ–‡ä»¶ã€‚</p>
<p>ä½†æ˜¯ä»æµ‹è¯•å’Œè¿ç»´çš„è§’åº¦æ¥çœ‹ï¼Œé‚£å°±åªæœ‰ä¸¤æ­¥ï¼šå¤åˆ¶ã€è¿è¡Œã€‚</p>
<p>æœ‰äº†è¿™ä¸ªé•œåƒæ–‡ä»¶ï¼Œæƒ³å¤åˆ¶åˆ°å“ªé‡Œè¿è¡Œéƒ½å¯ä»¥ï¼Œå®Œå…¨å’Œå¹³å°æ— å…³ã€‚</p>
<p>Dockerè¿™ç§å®¹å™¨æŠ€æœ¯éš”ç¦»å‡ºäº†ç‹¬ç«‹çš„è¿è¡Œç©ºé—´ï¼Œä¸ä¼šå’Œå…¶ä»–åº”ç”¨äº‰ç”¨ç³»ç»Ÿèµ„æºï¼Œä¸éœ€è¦è€ƒè™‘åº”ç”¨ä¹‹é—´çš„ç›¸äº’å½±å“ã€‚</p>
<p>å…¶æ¬¡ï¼Œå› ä¸ºåœ¨æ„å»ºé•œåƒæ—¶å°±å¤„ç†å®Œäº†æœåŠ¡ç¨‹åºå¯¹äºç³»ç»Ÿçš„æ‰€æœ‰ä¾èµ–ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨æ—¶ï¼Œå¯ä»¥å¿½ç•¥åŸæœ¬ç¨‹åºçš„ä¾èµ–ä»¥åŠå¼€å‘è¯­è¨€ã€‚å¯¹æµ‹è¯•å’Œè¿ç»´äººå‘˜è€Œè¨€ï¼Œå¯ä»¥æ›´ä¸“æ³¨äºè‡ªå·±çš„ä¸šåŠ¡å†…å®¹ã€‚</p>
<p>æœ€åï¼ŒDockerä¸ºå¼€å‘è€…æä¾›äº†ä¸€ç§å¼€å‘ç¯å¢ƒçš„ç®¡ç†åŠæ³•ï¼Œå¸®åŠ©æµ‹è¯•äººå‘˜ä¿è¯ç¯å¢ƒçš„åŒæ­¥ï¼Œä¸ºè¿ç»´äººå‘˜æä¾›äº†å¯ç§»æ¤çš„æ ‡å‡†åŒ–éƒ¨ç½²æµç¨‹ã€‚</p>
<hr>
<p><strong>ç±»       &ndash;&gt; å¯¹è±¡</strong></p>
<p><strong>é•œåƒ    &ndash;&gt; å®¹å™¨</strong></p>
<hr>
<h2 id="å®‰è£…">å®‰è£…<a hidden class="anchor" aria-hidden="true" href="#å®‰è£…">#</a></h2>
<h3 id="centos">centos<a hidden class="anchor" aria-hidden="true" href="#centos">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">uname -r</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">yum update</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">yum makecache fast</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">yum install docker-ce</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">docker version</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">systemctl status docker</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">systemctl start docker</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">// æµ‹è¯•</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">docker pull hello-world</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">docker run hello-world</span>
</span></span></code></pre></div><h3 id="ubuntu">Ubuntu<a hidden class="anchor" aria-hidden="true" href="#ubuntu">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</span>
</span></span></code></pre></div><h2 id="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤<a hidden class="anchor" aria-hidden="true" href="#å¸¸ç”¨å‘½ä»¤">#</a></h2>
<p><a href="https://www.bilibili.com/video/BV1gr4y1U7CY?p=18&amp;spm_id_from=pageDriver&amp;vd_source=6168fe2db91f9a8c4c41d41f39d1703e">https://www.bilibili.com/video/BV1gr4y1U7CY?p=18&amp;spm_id_from=pageDriver&amp;vd_source=6168fe2db91f9a8c4c41d41f39d1703e</a></p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">å¯åŠ¨docker:		systemctl start docker</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">åœæ­¢docker:		systemctl stop docker</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">é‡å¯docker:		systemctl restart docker</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">æŸ¥çœ‹dockerçŠ¶æ€:		systemctl status docker</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">å¼€æœºå¯åŠ¨:			systemctl enable docker</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">æŸ¥çœ‹dockeræ¦‚è¦ä¿¡æ¯:	docker info</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">æŸ¥çœ‹docker æ€»ä½“å¸®åŠ©æ–‡æ¡£:	docker-help</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">æŸ¥çœ‹docker å‘½ä»¤å¸®åŠ©æ–‡æ¡£:	dockerå…·ä½“å‘½ä»¤-help</span>
</span></span></code></pre></div><h2 id="docker-ä¸­å¤®ä»“åº“">docker ä¸­å¤®ä»“åº“<a hidden class="anchor" aria-hidden="true" href="#docker-ä¸­å¤®ä»“åº“">#</a></h2>
<p>å­˜æ”¾é•œåƒçš„ç½‘ç«™</p>
<p>å®˜ç½‘ï¼šhttps://hub.docker.com/</p>
<p>daocloudï¼šhttp://hub.daocloud.io/</p>
<h2 id="docker-é•œåƒæ“ä½œ">docker é•œåƒæ“ä½œ<a hidden class="anchor" aria-hidden="true" href="#docker-é•œåƒæ“ä½œ">#</a></h2>
<h3 id="æ‹‰å–åˆ°æœ¬åœ°">æ‹‰å–åˆ°æœ¬åœ°<a hidden class="anchor" aria-hidden="true" href="#æ‹‰å–åˆ°æœ¬åœ°">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker pull daocloud.io/library/tomcat:8.0.45
</span></span></code></pre></div><h3 id="æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰é•œåƒ">æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰é•œåƒ<a hidden class="anchor" aria-hidden="true" href="#æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰é•œåƒ">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker images
</span></span></code></pre></div><h3 id="åˆ é™¤">åˆ é™¤<a hidden class="anchor" aria-hidden="true" href="#åˆ é™¤">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>// æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„
</span></span><span style="display:flex;"><span>docker ps -a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker rm a66&lt;idå‰å‡ ä½&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker rmi é•œåƒæ ‡è¯†&lt;idå‰å‡ ä½&gt;
</span></span></code></pre></div><h3 id="é•œåƒå¯¼å‡ºå¯¼å…¥">é•œåƒå¯¼å‡ºå¯¼å…¥<a hidden class="anchor" aria-hidden="true" href="#é•œåƒå¯¼å‡ºå¯¼å…¥">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker save -o è·¯å¾„ é•œåƒid&lt;å‰ä¸¤ä½å³å¯&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker load -i é•œåƒæ–‡ä»¶
</span></span></code></pre></div><h3 id="ä¿®æ”¹é•œåƒåç§°">ä¿®æ”¹é•œåƒåç§°<a hidden class="anchor" aria-hidden="true" href="#ä¿®æ”¹é•œåƒåç§°">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker tag é•œåƒid æ–°é•œåƒåç§°:ç‰ˆæœ¬
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker tag fa tomcat:8.0
</span></span></code></pre></div><h2 id="docker-å®¹å™¨æ“ä½œ">docker å®¹å™¨æ“ä½œ<a hidden class="anchor" aria-hidden="true" href="#docker-å®¹å™¨æ“ä½œ">#</a></h2>
<h3 id="1è¿è¡Œå®¹å™¨">1ã€è¿è¡Œå®¹å™¨<a hidden class="anchor" aria-hidden="true" href="#1è¿è¡Œå®¹å™¨">#</a></h3>
<p>åŸºæœ¬æ“ä½œ</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker run é•œåƒçš„æ ‡è¯†é•œåƒåç§°[:tag] 
</span></span></code></pre></div><p>å¸¸ç”¨çš„å‚æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span> docker run -d -p å®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ --name å®¹å™¨åç§° é•œåƒçš„æ ‡è¯†é•œåƒåç§°[:tag] 
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span> docker run -d -p 8080:8080 --name tomcat fa
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span> è·‘èµ·æ¥åç›´æ¥è®¿é—®å³å¯
</span></span></code></pre></div><ul>
<li>-d: ä»£è¡¨åå°è¿è¡Œå®¹å™¨</li>
<li>-p å®¿ä¸»æœºç«¯å£ï¼šå®¹å™¨ç«¯å£ï¼šä¸ºäº†æ˜ å°„å½“å‰Liuxçš„ç«¯å£å’Œå®¹å™¨çš„ç«¯å£</li>
<li>&ndash;name å®¹å™¨åç§°ï¼šæŒ‡å®šå®¹å™¨çš„åç§°</li>
</ul>
<h3 id="2æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨">2ã€æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨<a hidden class="anchor" aria-hidden="true" href="#2æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker ps [-qa]
</span></span></code></pre></div><ul>
<li>-aï¼šæŸ¥çœ‹å…¨éƒ¨çš„å®¹å™¨ï¼ŒåŒ…æ‹¬æ²¡æœ‰è¿è¡Œ</li>
<li>-qï¼šåªæŸ¥çœ‹å®¹å™¨å¾—åˆ°æ ‡è¯†</li>
</ul>
<h3 id="3æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿—">3ã€æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿—<a hidden class="anchor" aria-hidden="true" href="#3æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿—">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker logs -f å®¹å™¨id
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[root@localhost linbin]# docker ps
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE     COMMAND             CREATED         STATUS
</span></span><span style="display:flex;"><span>b01afd80c224   fa        &#34;catalina.sh run&#34;   5 minutes ago   Up 5 minutes   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[root@localhost linbin]# docker logs -f b0
</span></span><span style="display:flex;"><span>08-Sep-2022 00:49:48.918 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version:        Apache Tomcat/8.0.45
</span></span><span style="display:flex;"><span>08-Sep-2022 00:49:48.921 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server built:          Jun 26 2017 20:06:07 UTC   8.0.45.0
</span></span><span style="display:flex;"><span>08-Sep-2022 00:49:48.921 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Name:               Linux
</span></span></code></pre></div><h3 id="4è¿›å…¥åˆ°å®¹å™¨å†…éƒ¨">4ã€è¿›å…¥åˆ°å®¹å™¨å†…éƒ¨<a hidden class="anchor" aria-hidden="true" href="#4è¿›å…¥åˆ°å®¹å™¨å†…éƒ¨">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker exec -it å®¹å™¨id bash
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[root@localhost linbin]# docker exec -it b0 bash
</span></span><span style="display:flex;"><span>root@b01afd80c224:/usr/local/tomcat# pwd
</span></span><span style="display:flex;"><span>/usr/local/tomcat
</span></span><span style="display:flex;"><span>root@b01afd80c224:/usr/local/tomcat# ls
</span></span><span style="display:flex;"><span>LICENSE  NOTICE  RELEASE-NOTES	RUNNING.txt  bin  conf	include  lib  logs  native-jni-lib  temp  webapps  work
</span></span><span style="display:flex;"><span>root@b01afd80c224:/usr/local/tomcat# cd webapps
</span></span><span style="display:flex;"><span>root@b01afd80c224:/usr/local/tomcat/webapps# ls
</span></span><span style="display:flex;"><span>ROOT  docs  examples  host-manager  manager
</span></span><span style="display:flex;"><span>root@b01afd80c224:/usr/local/tomcat/webapps# exit
</span></span><span style="display:flex;"><span>exit
</span></span></code></pre></div><h3 id="5åˆ é™¤å®¹å™¨">5ã€åˆ é™¤å®¹å™¨<a hidden class="anchor" aria-hidden="true" href="#5åˆ é™¤å®¹å™¨">#</a></h3>
<p>(åˆ é™¤å®¹å™¨å‰ï¼Œéœ€è¦å…ˆåœæ­¢å®¹å™¨)</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>#åœæ­¢æŒ‡å®šçš„å®¹å™¨
</span></span><span style="display:flex;"><span>docker stop å®¹å™¨id
</span></span><span style="display:flex;"><span>#åœæ­¢å…¨éƒ¨å®¹å™¨
</span></span><span style="display:flex;"><span>docker stop $(docker ps -qa)
</span></span><span style="display:flex;"><span>#åˆ é™¤æŒ‡å®šå®¹å™¨
</span></span><span style="display:flex;"><span>docker rm å®¹å™¨id
</span></span><span style="display:flex;"><span>#åˆ é™¤å…¨éƒ¨å®¹å™¨
</span></span><span style="display:flex;"><span>docker rm $(docker ps -qa)
</span></span><span style="display:flex;"><span>#å¯åŠ¨å®¹å™¨
</span></span><span style="display:flex;"><span>docker start å®¹å™¨id
</span></span></code></pre></div><h2 id="åˆ›å»º-mysql-å®¹å™¨">åˆ›å»º mysql å®¹å™¨<a hidden class="anchor" aria-hidden="true" href="#åˆ›å»º-mysql-å®¹å™¨">#</a></h2>
<p>åˆ›å»ºMySQLé•œåƒ</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker pull daocloud.io/library/mysq1:5.7.5-m15
</span></span></code></pre></div><p>æŸ¥çœ‹MySQLé•œåƒ</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker images
</span></span></code></pre></div><p>åˆ›å»ºMySQLå®¹å™¨</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker run -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=root --name msyql é•œåƒtag
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>egï¼š
</span></span><span style="display:flex;"><span>docker run -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=Admin666 --name mysql 644
</span></span></code></pre></div><p>ç„¶åä½¿ç”¨è¿æ¥å·¥å…· Navicat æµ‹è¯•ã€‚</p>
<h3 id="å‘1--ä¸­æ–‡å­—ç¬¦">å‘1&ndash;ä¸­æ–‡å­—ç¬¦<a hidden class="anchor" aria-hidden="true" href="#å‘1--ä¸­æ–‡å­—ç¬¦">#</a></h3>
<p>æŸ¥çœ‹é‡Œé¢çš„å­—ç¬¦é›†ï¼Œå¥½å®¶ä¼™ï¼ŒLatin1</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">mysql&gt; SHOW VARIABLES LIKE &#39;character%&#39;;</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">+--------------------------+----------------------------+</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">| Variable_name            | Value                      |</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">+--------------------------+----------------------------+</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">| character_set_client     | latin1                     |</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">| character_set_connection | latin1                     |</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">| character_set_database   | utf8                       |</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">| character_set_filesystem | binary                     |</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">| character_set_results    | latin1                     |</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">| character_set_server     | latin1                     |</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">| character_set_system     | utf8                       |</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">| character_sets_dir       | /usr/share/mysql/charsets/ |</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">+--------------------------+----------------------------+</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">8 rows in set (0.00 sec)</span>
</span></span></code></pre></div><h3 id="å…³é”®ç‚¹2--å¼€å¯æ•°æ®å·">å…³é”®ç‚¹2&ndash;å¼€å¯æ•°æ®å·<a hidden class="anchor" aria-hidden="true" href="#å…³é”®ç‚¹2--å¼€å¯æ•°æ®å·">#</a></h3>
<p>åˆ é™¤å®¹å™¨åï¼Œé‡Œé¢çš„mysqlæ•°æ®å¦‚ä½•åŠ
å®¹å™¨å®ä¾‹ä¸€åˆ é™¤ï¼Œå•¥æ•°æ®ä¹Ÿæ²¡äº†ï¼</p>
<h3 id="è§£å†³åŠæ³•">è§£å†³åŠæ³•<a hidden class="anchor" aria-hidden="true" href="#è§£å†³åŠæ³•">#</a></h3>
<p>1ã€æ–°å¢æ•°æ®å·</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">docker run -d -p 3306:3306 --privileged</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">true </span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">-v /zzyyuse/mysql/log:/var/log/mysql </span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">-v /zzyyuse/mysql/data:/var/lib/mysql </span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">-v /zzyyuse/mysql/conf:/etc/mysql/conf.d </span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">-e MYSQL_ROOT_PASSWORD</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">123456  </span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">--name mysql mysql:5.7</span>
</span></span></code></pre></div><p>2ã€/zzyyuse/mysql/conf ä¸‹æ–°å¢ my.cnf</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#ff6ac1">[client]</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">default_character_set</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">utf8</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[mysqld]</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">collation_server</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">utf8_general_ci</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">character_set_server</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">utf8</span>
</span></span></code></pre></div><p>ç„¶årestartä¸€ä¸‹</p>
<blockquote>
<p>ä¹‹å‰çš„DB æ— æ•ˆ</p>
<p>ä¿®æ”¹å­—ç¬¦é›†æ“ä½œ+é‡å¯mysqlå®¹å™¨å®ä¾‹</p>
<p>ä¹‹åçš„DB æœ‰æ•ˆï¼Œéœ€è¦æ–°å»º</p>
<p>ç»“è®ºï¼šdockerå®‰è£…å®ŒMySQLå¹¶runå‡ºå®¹å™¨åï¼Œå»ºè®®è¯·å…ˆä¿®æ”¹å®Œå­—ç¬¦é›†ç¼–ç åå†æ–°å»ºmysqlåº“-è¡¨-æ’æ•°æ®</p>
</blockquote>
<h2 id="å°†é¡¹ç›®éƒ¨ç½²åˆ°tomcat">å°†é¡¹ç›®éƒ¨ç½²åˆ°Tomcat<a hidden class="anchor" aria-hidden="true" href="#å°†é¡¹ç›®éƒ¨ç½²åˆ°tomcat">#</a></h2>
<h3 id="ä¸Šä¼ é¡¹ç›®">ä¸Šä¼ é¡¹ç›®<a hidden class="anchor" aria-hidden="true" href="#ä¸Šä¼ é¡¹ç›®">#</a></h3>
<p>ä¸Šä¼ é¡¹ç›®</p>
<h3 id="è¿›å…¥å®¹å™¨ç›®å½•">è¿›å…¥å®¹å™¨ç›®å½•<a hidden class="anchor" aria-hidden="true" href="#è¿›å…¥å®¹å™¨ç›®å½•">#</a></h3>
<p>docker exec -it å®¹å™¨tag bash</p>
<h3 id="å°†é¡¹ç›®æ‹·è´åˆ°tomcatå®¹å™¨çš„webappsç›®å½•ä¸‹é¢">å°†é¡¹ç›®æ‹·è´åˆ°tomcat:å®¹å™¨çš„webappsç›®å½•ä¸‹é¢<a hidden class="anchor" aria-hidden="true" href="#å°†é¡¹ç›®æ‹·è´åˆ°tomcatå®¹å™¨çš„webappsç›®å½•ä¸‹é¢">#</a></h3>
<p>docker cp demo a17:/usr/local/tomcat/webapps</p>
<h3 id="æŸ¥çœ‹tomcatè¿è¡Œæ—¥å¿—">æŸ¥çœ‹tomcatè¿è¡Œæ—¥å¿—<a hidden class="anchor" aria-hidden="true" href="#æŸ¥çœ‹tomcatè¿è¡Œæ—¥å¿—">#</a></h3>
<p>docker logs -f å®¹å™¨tag</p>
<h2 id="docker-æ•°æ®å·">docker æ•°æ®å·<a hidden class="anchor" aria-hidden="true" href="#docker-æ•°æ®å·">#</a></h2>
<p>ä¸ºäº†éƒ¨ç½²æˆ‘ä»¬çš„demoå·¥ç¨‹ï¼Œéœ€è¦ä½¿ç”¨åˆ° cp çš„å‘½ä»¤å°†å®¿ä¸»æœºå†…çš„ demoæ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨å†…éƒ¨</p>
<p>æ•°æ®å·ï¼š<strong>å°†å®¿ä¸»æœºçš„ä¸€ä¸ªç›®å½•ï¼Œæ˜ å°„åˆ°å®¹å™¨çš„ä¸€ä¸ªç›®å½•ä¸­</strong>ï¼Œå¯ä»¥åœ¨å®¿ä¸»æœºä¸­æ“ä½œç›®å½•ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆå®¹å™¨å†…éƒ¨æ˜ å°„çš„æ–‡ä»¶ï¼Œä¹Ÿä¼šè·Ÿç€ä¸€èµ·æ”¹å˜ã€‚</p>
<p>åœ¨æŒ‚è½½ç›®å½•åå¤šåŠ ä¸€ä¸ªå‚æ•° <code>--privileged=true</code></p>
<h3 id="1åˆ›å»ºæ•°æ®å·">1.åˆ›å»ºæ•°æ®å·<a hidden class="anchor" aria-hidden="true" href="#1åˆ›å»ºæ•°æ®å·">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker volume create æ•°æ®å·åç§°
</span></span><span style="display:flex;"><span>#åˆ›å»ºæ•°æ®å·ä¹‹åï¼Œé»˜è®¤ä¼šå­˜æ”¾åœ¨ä¸€ä¸ªç›®å½•ä¸‹/var/Tb/docker/volumes./æ•°æ®å·åç§°/_data
</span></span></code></pre></div><h3 id="2æŸ¥çœ‹æ•°æ®å·çš„è¯¦ç»†ä¿¡æ¯">2.æŸ¥çœ‹æ•°æ®å·çš„è¯¦ç»†ä¿¡æ¯<a hidden class="anchor" aria-hidden="true" href="#2æŸ¥çœ‹æ•°æ®å·çš„è¯¦ç»†ä¿¡æ¯">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker volume inspect æ•°æ®å·åç§°
</span></span></code></pre></div><h3 id="3æŸ¥çœ‹å…¨éƒ¨æ•°æ®å·">3.æŸ¥çœ‹å…¨éƒ¨æ•°æ®å·<a hidden class="anchor" aria-hidden="true" href="#3æŸ¥çœ‹å…¨éƒ¨æ•°æ®å·">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker volume ls
</span></span></code></pre></div><h3 id="4åˆ é™¤æ•°æ®å·">4.åˆ é™¤æ•°æ®å·<a hidden class="anchor" aria-hidden="true" href="#4åˆ é™¤æ•°æ®å·">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker volume rm æ•°æ®å·åç§°
</span></span></code></pre></div><h3 id="5åº”ç”¨æ•°æ®å·">5.åº”ç”¨æ•°æ®å·<a hidden class="anchor" aria-hidden="true" href="#5åº”ç”¨æ•°æ®å·">#</a></h3>
<p>å½“ä½ æ˜ å°„æ•°æ®å·æ—¶ï¼Œå¦‚æœæ•°æ®å·ä¸å­˜åœ¨ã€‚Dockerä¼šå¸®ä½ è‡ªåŠ¨åˆ›å»ºï¼Œä¼šå°†å®¹å™¨å†…éƒ¨è‡ªå¸¦çš„æ–‡ä»¶ï¼Œå­˜å‚¨åœ¨é»˜è®¤çš„å­˜æ”¾è·¯å¾„ä¸­ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker run -v æ•°æ®å·åç§°:å®¹å™¨å†…éƒ¨çš„è·¯å¾„é•œåƒid
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#ç›´æ¥æŒ‡å®šä¸€ä¸ªè·¯å¾„ä½œä¸ºæ•°æ®å·çš„å­˜æ”¾ä½ç½®ã€‚è¿™ä¸ªè·¯å¾„ä¸‹æ˜¯ç©ºçš„ã€‚
</span></span><span style="display:flex;"><span>docker run -V å®¿ä¸»æœºè·¯å¾„:å®¹å™¨å†…éƒ¨çš„è·¯å¾„ é•œåƒid
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker run -d -p 8080:8080 -v /home/tomcat_webapps:/usr/local/tomcat/webapps/ --name tomcat fa6
</span></span></code></pre></div><h3 id="æµ‹è¯•">æµ‹è¯•<a hidden class="anchor" aria-hidden="true" href="#æµ‹è¯•">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">docker run -d --privileged</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">true -v /tmp/host_data/:/tmp/docker_data/ --name u1 ubuntu</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">[root@iZwz982ksp86xdjeeirtsdZ tmp]# cd /tmp/host_data/</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">[root@iZwz982ksp86xdjeeirtsdZ host_data]# touch test.txt</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">[root@iZwz982ksp86xdjeeirtsdZ host_data]# ls</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">test.txt</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">[root@iZwz982ksp86xdjeeirtsdZ host_data]# docker exec -it afb bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@afb5e67ee3d4:/# cd /tmp/docker_data/</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@afb5e67ee3d4:/tmp/docker_data# ls</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">test.txt</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@afb5e67ee3d4:/tmp/docker_data#</span>
</span></span></code></pre></div><p>æŸ¥çœ‹æ˜¯å¦æŒ‚è½½æˆåŠŸ</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">[root@iZwz982ksp86xdjeeirtsdZ host_data]# docker inspect af</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#57c7ff">&#34;Mounts&#34;: [</span>
</span></span><span style="display:flex;"><span>            <span style="color:#57c7ff">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#57c7ff">&#34;Type&#34;: &#34;bind&#34;,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#57c7ff">&#34;Source&#34;: &#34;/tmp/host_data&#34;,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#57c7ff">&#34;Destination&#34;: &#34;/tmp/docker_data&#34;,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#57c7ff">&#34;Mode&#34;: &#34;&#34;,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#57c7ff">&#34;RW&#34;: true,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#57c7ff">&#34;Propagation&#34;: &#34;rprivate&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#57c7ff">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#57c7ff">],</span>
</span></span></code></pre></div><p>å¦‚æœ docker stop äº†ï¼Œç„¶ååœ¨å®¿ä¸»æœºç»‘å®šçš„ç›®å½•æ–°å¢äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶ååœ¨ start ä¸€ä¸‹ï¼Œå‘ç°ä¼šåŒæ­¥è¿‡æ¥ã€‚</p>
<p>æ˜¯å…±äº«çš„æ„æ€ã€‚</p>
<h3 id="åªè¯»">åªè¯»<a hidden class="anchor" aria-hidden="true" href="#åªè¯»">#</a></h3>
<p>ä¸Šé¢é»˜è®¤rw</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">docker run -it -privileged</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">true -v /å®¿ä¸»æœºç»å¯¹è·¯å¾„ç›®å½•:/å®¹å™¨å†…ç›®å½•:ro é•œåƒå</span>
</span></span></code></pre></div><p>/å®¹å™¨ç›®å½•:ro é•œåƒå        å°±èƒ½å®ŒæˆåŠŸèƒ½ï¼Œæ­¤æ—¶å®¹å™¨è‡ªå·±åªèƒ½è¯»å–ä¸èƒ½å†™</p>
<p>ro = read only</p>
<p>æ­¤æ—¶å¦‚æœå®¿ä¸»æœºå†™å…¥å†…å®¹ï¼Œå¯ä»¥åŒæ­¥ç»™å®¹å™¨å†…ï¼Œå®¹å™¨å¯ä»¥è¯»å–åˆ°ã€‚</p>
<h3 id="ç»§æ‰¿">ç»§æ‰¿<a hidden class="anchor" aria-hidden="true" href="#ç»§æ‰¿">#</a></h3>
<p>å®¹å™¨1å®Œæˆå’Œå®¿ä¸»æœºçš„æ˜ å°„
å®¹å™¨2ç»§æ‰¿å®¹å™¨1çš„å·è§„åˆ™
ä¸€</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">docker run -it --privileged</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">true --volumes-from  çˆ¶äº² --name u2 ubuntu</span>
</span></span></code></pre></div><h2 id="dockerfile">Dockerfile<a hidden class="anchor" aria-hidden="true" href="#dockerfile">#</a></h2>
<h3 id="ä»€ä¹ˆæ˜¯dockerfile">ä»€ä¹ˆæ˜¯Dockerfile?<a hidden class="anchor" aria-hidden="true" href="#ä»€ä¹ˆæ˜¯dockerfile">#</a></h3>
<hr>
<p><a href="https://blog.csdn.net/m0_46090675/article/details/121846718">DockerFileè¯¦è§£</a></p>
<hr>
<p>Dockerfileæ˜¯ä¸€ä¸ªåŒ…å«ç”¨äºç»„åˆæ˜ åƒçš„å‘½ä»¤çš„æ–‡æœ¬æ–‡æ¡£ã€‚å¯ä»¥ä½¿ç”¨åœ¨å‘½ä»¤è¡Œä¸­è°ƒç”¨çš„ä»»ä½•å‘½ä»¤ã€‚</p>
<p>Dockeré€šè¿‡è¯»å–Dockerfileä¸­çš„æŒ‡ä»¤è‡ªåŠ¨ç”Ÿæˆæ˜ åƒã€‚</p>
<p><code>docker build </code>å‘½ä»¤ç”¨äºä» Dockerfile æ„å»ºæ˜ åƒã€‚</p>
<p>å¯ä»¥åœ¨<code>docker buiId</code>å‘½ä»¤ä¸­ä½¿ç”¨<code>-f</code>æ ‡å¿—æŒ‡å‘æ–‡ä»¶ç³»ç»Ÿä¸­ä»»ä½•ä½ç½®çš„Dockerfileã€‚</p>
<p>ä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>docker build -f /path/to/a/Dockerfile
</span></span></code></pre></div><h3 id="dockerfileçš„åŸºæœ¬ç»“æ„">Dockerfileçš„åŸºæœ¬ç»“æ„<a hidden class="anchor" aria-hidden="true" href="#dockerfileçš„åŸºæœ¬ç»“æ„">#</a></h3>
<p>Dockerfileä¸€èˆ¬åˆ†ä¸ºå››éƒ¨åˆ†ï¼š</p>
<p>1.åŸºç¡€é•œåƒä¿¡æ¯</p>
<p>2.ç»´æŠ¤è€…ä¿¡æ¯</p>
<p>3.é•œåƒæ“ä½œæŒ‡ä»¤</p>
<p>4.å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡ŒæŒ‡ä»¤</p>
<h3 id="dockerfileæ–‡ä»¶è¯´æ˜">Dockerfileæ–‡ä»¶è¯´æ˜<a hidden class="anchor" aria-hidden="true" href="#dockerfileæ–‡ä»¶è¯´æ˜">#</a></h3>
<p>Dockerä»¥ä»ä¸Šåˆ°ä¸‹çš„é¡ºåºè¿è¡Œ Dockerfile çš„æŒ‡ä»¤ã€‚ä¸ºäº†æŒ‡å®šåŸºæœ¬æ˜ åƒï¼Œç¬¬ä¸€æ¡æŒ‡ä»¤å¿…é¡»æ˜¯FROMã€‚ä¸€ä¸ªå£°æ˜ä»¥#å­—ç¬¦å¼€å¤´åˆ™è¢«è§†ä¸ºæ³¨é‡Šã€‚å¯ä»¥åœ¨Dockeræ–‡ä»¶ä¸­ä½¿ç”¨<code>RUN,CMD,FROM,EXPOSE,ENV</code>ç­‰æŒ‡ä»¤ã€‚</p>
<p>åœ¨è¿™é‡Œåˆ—å‡ºäº†ä¸€äº›å ‚ç”¨çš„æŒ‡ä»¤.</p>
<h3 id="æŒ‡ä»¤">æŒ‡ä»¤<a hidden class="anchor" aria-hidden="true" href="#æŒ‡ä»¤">#</a></h3>
<h4 id="from">FROM<a hidden class="anchor" aria-hidden="true" href="#from">#</a></h4>
<p>æŒ‡å®šåŸºç¡€é•œåƒï¼Œå¿…é¡»ä¸ºç¬¬ä¸€ä¸ªå‘½ä»¤</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">æ ¼å¼ï¼š</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">FROM &lt;image&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">FROM &lt;image&gt;:&lt;tag&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">FROM &lt;image&gt;@&lt;digest&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">ç¤ºä¾‹ï¼š</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">FROM mysq1:5.6</span>
</span></span></code></pre></div><blockquote>
<p>æ³¨ï¼štagæˆ–digestæ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¸ä½¿ç”¨è¿™ä¸¤ä¸ªå€¼æ—¶ï¼Œä¼šä½¿ç”¨jlatestç‰ˆæœ¬çš„åŸºç¡€é•œåƒ</p>
</blockquote>
<h4 id="maintainer">MAINTAINER<a hidden class="anchor" aria-hidden="true" href="#maintainer">#</a></h4>
<p>ç»´æŠ¤è€…ä¿¡æ¯</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">æ ¼å¼ï¼š</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">MAINTAINER &lt;name&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">ç¤ºä¾‹ï¼š</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">MAINTAINER Jasper Xu</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">MAINTAINER sorex@163.com</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">MAINTAINER Jasper Xu &lt;sorex@163.com&gt;</span>
</span></span></code></pre></div><h4 id="run">RUN<a hidden class="anchor" aria-hidden="true" href="#run">#</a></h4>
<p>æ„å»ºé•œåƒæ—¶æ‰§è¡Œçš„å‘½ä»¤</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">RUNç”¨äºåœ¨é•œåƒå®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤ï¼Œå…¶æœ‰ä»¥ä¸‹ä¸¤ç§å‘½ä»¤æ‰§è¡Œæ–¹å¼ï¼š</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">shellæ‰§è¡Œ</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">æ ¼å¼ï¼š</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">RUN &lt;command&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">execæ‰§è¡Œ</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">æ ¼å¼ï¼š</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">RUN [&#34;executable&#34;,&#34;paraml&#34;,&#34;param2&#34;]</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">ç¤ºä¾‹ï¼š</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">RUN [&#34;executable&#34;,&#34;param1&#34;,&#34;param2&#34;]</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">RUN apk update</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">RUN [&#34;/etc/execfile&#34;,&#34;arg1&#34;,&#34;arg1&#34;]</span>
</span></span></code></pre></div><blockquote>
<p>æ³¨ï¼šRUNæŒ‡ä»¤åˆ›å»ºçš„ä¸­é—´é•œåƒä¼šè¢«ç¼“å­˜ï¼Œå¹¶ä¼šåœ¨ä¸‹æ¬¡æ„å»ºä¸­ä½¿ç”¨ã€‚å¦‚æœä¸æƒ³ä½¿ç”¨è¿™äº›ç¼“å­˜é•œåƒï¼Œå¯ä»¥åœ¨æ„å»ºæ—¶æŒ‡å®š&ndash;no-cacheå‚æ•°ï¼Œå¦‚ï¼šdocker build &ndash;no-cache</p>
</blockquote>
<h4 id="add">ADD<a hidden class="anchor" aria-hidden="true" href="#add">#</a></h4>
<p>ADD æŒ‡ä»¤å’Œ COPY çš„ä½¿ç”¨æ ¼ç±»ä¼¼ï¼ˆåŒæ ·éœ€æ±‚ä¸‹ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ COPYï¼‰ã€‚åŠŸèƒ½ä¹Ÿç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„å¦‚ä¸‹ï¼š</p>
<ul>
<li>ADD çš„ä¼˜ç‚¹ï¼šåœ¨æ‰§è¡Œ &lt;æºæ–‡ä»¶&gt; ä¸º tar å‹ç¼©æ–‡ä»¶çš„è¯ï¼Œå‹ç¼©æ ¼å¼ä¸º gzip, bzip2 ä»¥åŠ xz çš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨å¤åˆ¶å¹¶è§£å‹åˆ° &lt;ç›®æ ‡è·¯å¾„&gt;ã€‚</li>
<li>ADD çš„ç¼ºç‚¹ï¼šåœ¨ä¸è§£å‹çš„å‰æä¸‹ï¼Œæ— æ³•å¤åˆ¶ tar å‹ç¼©æ–‡ä»¶ã€‚ä¼šä»¤é•œåƒæ„å»ºç¼“å­˜å¤±æ•ˆï¼Œä»è€Œå¯èƒ½ä¼šä»¤é•œåƒæ„å»ºå˜å¾—æ¯”è¾ƒç¼“æ…¢ã€‚å…·ä½“æ˜¯å¦ä½¿ç”¨ï¼Œå¯ä»¥æ ¹æ®æ˜¯å¦éœ€è¦è‡ªåŠ¨è§£å‹æ¥å†³å®šã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#ff5c57">æ ¼å¼ï¼š</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">ADD</span> <span style="color:#ff6ac1">&lt;</span>src<span style="color:#ff6ac1">&gt;</span>...<span style="color:#ff6ac1">&lt;</span>dest<span style="color:#ff6ac1">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">ADD</span>[<span style="color:#5af78e">&#34;&lt;src&gt;&#34;</span>,...<span style="color:#5af78e">&#34;&lt;dest&gt;&#34;</span> <span style="color:#ff5c57">ç”¨äºæ”¯æŒåŒ…å«ç©ºæ ¼çš„è·¯å¾„</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">ç¤ºä¾‹ï¼š</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">ADD</span> hom<span style="color:#ff6ac1">*</span> <span style="color:#ff6ac1">/</span>mydir<span style="color:#ff6ac1">/</span>			<span style="color:#78787e">#æ·»åŠ æ‰€æœ‰ä»¥&#34;hom&#34;å¼€å¤´çš„æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff6ac1">ADD</span> hom<span style="color:#ff6ac1">?</span>.txt <span style="color:#ff6ac1">/</span>mydir<span style="color:#ff6ac1">/</span>		<span style="color:#78787e">#?æ›¿ä»£ä¸€ä¸ªå•å­—ç¬¦ï¼Œä¾‹å¦‚ï¼š&#34;home.txt&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff6ac1">ADD</span> test relativeDir<span style="color:#ff6ac1">/</span>		<span style="color:#78787e">#æ·»åŠ &#34;test&#34;åˆ°`WORKDIR`/relativeDir/
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff6ac1">ADD</span> test <span style="color:#ff6ac1">/</span>absoluteDir<span style="color:#ff6ac1">/</span>		<span style="color:#78787e">#æ·»åŠ &#34;test&#34;åˆ°/absoluteDir/
</span></span></span></code></pre></div><h4 id="cmd">CMD<a hidden class="anchor" aria-hidden="true" href="#cmd">#</a></h4>
<p>ç±»ä¼¼äº RUN æŒ‡ä»¤ï¼Œç”¨äºè¿è¡Œç¨‹åºï¼Œä½†äºŒè€…è¿è¡Œçš„æ—¶é—´ç‚¹ä¸åŒ:</p>
<ul>
<li>CMD åœ¨docker run æ—¶è¿è¡Œã€‚</li>
<li>RUN æ˜¯åœ¨ docker buildã€‚</li>
</ul>
<p><strong>ä½œç”¨</strong>ï¼šä¸ºå¯åŠ¨çš„å®¹å™¨æŒ‡å®šé»˜è®¤è¦è¿è¡Œçš„ç¨‹åºï¼Œç¨‹åºè¿è¡Œç»“æŸï¼Œå®¹å™¨ä¹Ÿå°±ç»“æŸã€‚CMD æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºå¯è¢« docker run å‘½ä»¤è¡Œå‚æ•°ä¸­æŒ‡å®šè¦è¿è¡Œçš„ç¨‹åºæ‰€è¦†ç›–ã€‚</p>
<p><strong>æ³¨æ„</strong>ï¼šå¦‚æœ Dockerfile ä¸­å¦‚æœå­˜åœ¨å¤šä¸ª CMD æŒ‡ä»¤ï¼Œä»…æœ€åä¸€ä¸ªç”Ÿæ•ˆã€‚</p>
<p>æ ¼å¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>CMD &lt;shell å‘½ä»¤&gt; 
</span></span><span style="display:flex;"><span>CMD [&#34;&lt;å¯æ‰§è¡Œæ–‡ä»¶æˆ–å‘½ä»¤&gt;&#34;,&#34;&lt;param1&gt;&#34;,&#34;&lt;param2&gt;&#34;,...] 
</span></span><span style="display:flex;"><span>CMD [&#34;&lt;param1&gt;&#34;,&#34;&lt;param2&gt;&#34;,...]  # è¯¥å†™æ³•æ˜¯ä¸º ENTRYPOINT æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºæä¾›é»˜è®¤å‚æ•°
</span></span></code></pre></div><p>æ¨èä½¿ç”¨ç¬¬äºŒç§æ ¼å¼ï¼Œæ‰§è¡Œè¿‡ç¨‹æ¯”è¾ƒæ˜ç¡®ã€‚ç¬¬ä¸€ç§æ ¼å¼å®é™…ä¸Šåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šè‡ªåŠ¨è½¬æ¢æˆç¬¬äºŒç§æ ¼å¼è¿è¡Œï¼Œå¹¶ä¸”é»˜è®¤å¯æ‰§è¡Œæ–‡ä»¶æ˜¯ shã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"></code></pre></div><h4 id="copy">COPY<a hidden class="anchor" aria-hidden="true" href="#copy">#</a></h4>
<p>å¤åˆ¶æŒ‡ä»¤ï¼Œä»ä¸Šä¸‹æ–‡ç›®å½•ä¸­å¤åˆ¶æ–‡ä»¶æˆ–è€…ç›®å½•åˆ°å®¹å™¨é‡ŒæŒ‡å®šè·¯å¾„ã€‚</p>
<p>æ ¼å¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>COPY [--chown=&lt;user&gt;:&lt;group&gt;] &lt;æºè·¯å¾„1&gt;...  &lt;ç›®æ ‡è·¯å¾„&gt;
</span></span><span style="display:flex;"><span>COPY [--chown=&lt;user&gt;:&lt;group&gt;] [&#34;&lt;æºè·¯å¾„1&gt;&#34;,...  &#34;&lt;ç›®æ ‡è·¯å¾„&gt;&#34;]
</span></span></code></pre></div><p><strong>[&ndash;chown=<user>:<group>]</strong>ï¼šå¯é€‰å‚æ•°ï¼Œç”¨æˆ·æ”¹å˜å¤åˆ¶åˆ°å®¹å™¨å†…æ–‡ä»¶çš„æ‹¥æœ‰è€…å’Œå±ç»„ã€‚</p>
<p><strong>&lt;æºè·¯å¾„&gt;</strong>ï¼šæºæ–‡ä»¶æˆ–è€…æºç›®å½•ï¼Œè¿™é‡Œå¯ä»¥æ˜¯é€šé…ç¬¦è¡¨è¾¾å¼ï¼Œå…¶é€šé…ç¬¦è§„åˆ™è¦æ»¡è¶³ Go çš„ filepath.Match è§„åˆ™ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>COPY hom* /mydir/
</span></span><span style="display:flex;"><span>COPY hom?.txt /mydir/
</span></span></code></pre></div><p><strong>&lt;ç›®æ ‡è·¯å¾„&gt;</strong>ï¼šå®¹å™¨å†…çš„æŒ‡å®šè·¯å¾„ï¼Œè¯¥è·¯å¾„ä¸ç”¨äº‹å…ˆå»ºå¥½ï¼Œè·¯å¾„ä¸å­˜åœ¨çš„è¯ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">FROM centos</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># æ·»åŠ æ–‡ä»¶åˆ°ç›®å½•ä¸‹</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">COPY test.txt /mydir/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># å°†æ–‡ä»¶å†…å®¹å†™å…¥ mytest</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">COPY test.txt /mytest</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># å‹ç¼©æ–‡ä»¶,è‡ªåŠ¨è§£å‹</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">COPY jmeter.log.zip /myzipdir/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># æ·»åŠ ç›®å½•</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">COPY TeamFile /</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># å…¶ä»–æ–‡ä»¶</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">COPY jmeter.log /mydir/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># å¤šä¸ªæ–‡ä»¶</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">COPY test1.txt test2.txt /mydir/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># é€šé…ç¬¦,dest ä¸å­˜åœ¨è‡ªåŠ¨åˆ›å»º</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">COPY test*.txt /mydir/test/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># ç‰¹æ®Šå­—ç¬¦ä¸²</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">COPY COPY[[]0].txt /mydir/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">WORKDIR /data</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># ç›¸å¯¹è·¯å¾„</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">COPY test.txt test/</span>
</span></span></code></pre></div><h4 id="volume">VOLUME<a hidden class="anchor" aria-hidden="true" href="#volume">#</a></h4>
<p>å®šä¹‰åŒ¿åæ•°æ®å·ã€‚åœ¨å¯åŠ¨å®¹å™¨æ—¶å¿˜è®°æŒ‚è½½æ•°æ®å·ï¼Œä¼šè‡ªåŠ¨æŒ‚è½½åˆ°åŒ¿åå·ã€‚</p>
<p>ä½œç”¨ï¼š</p>
<ul>
<li>é¿å…é‡è¦çš„æ•°æ®ï¼Œå› å®¹å™¨é‡å¯è€Œä¸¢å¤±ï¼Œè¿™æ˜¯éå¸¸è‡´å‘½çš„ã€‚</li>
<li>é¿å…å®¹å™¨ä¸æ–­å˜å¤§ã€‚</li>
</ul>
<p>æ ¼å¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>VOLUME [&#34;&lt;è·¯å¾„1&gt;&#34;, &#34;&lt;è·¯å¾„2&gt;&#34;...]
</span></span><span style="display:flex;"><span>VOLUME &lt;è·¯å¾„&gt;
</span></span></code></pre></div><h3 id="å°š">å°š<a hidden class="anchor" aria-hidden="true" href="#å°š">#</a></h3>
<h2 id="docker-è‡ªå®šä¹‰é•œåƒ">docker è‡ªå®šä¹‰é•œåƒ<a hidden class="anchor" aria-hidden="true" href="#docker-è‡ªå®šä¹‰é•œåƒ">#</a></h2>
<p><a href="https://www.bilibili.com/video/BV1zR4y1t7Wj?p=178&amp;spm_id_from=pageDriver&amp;vd_source=6168fe2db91f9a8c4c41d41f39d1703e">è‡ªå®šä¹‰é•œåƒ</a></p>
<h2 id="docker-compose">docker-compose<a hidden class="anchor" aria-hidden="true" href="#docker-compose">#</a></h2>
<p><strong>éœ€æ±‚</strong></p>
<p>ä¹‹å‰è¿è¡Œä¸€ä¸ªé•œåƒï¼Œéœ€è¦æ·»åŠ å¤§é‡çš„å‚æ•°ã€‚</p>
<p>å¯ä»¥é€šè¿‡Docker-Composeç¼–å†™è¿™äº›å‚æ•°ã€‚</p>
<p>Docker-Composeå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ‰¹é‡çš„ç®¡ç†å®¹å™¨ã€‚</p>
<p>åªéœ€è¦é€šè¿‡ä¸€ä¸ª<code>docker-compose.yml</code>æ–‡ä»¶å»ç»´æŠ¤å³å¯ã€‚</p>
<p><strong>ä¸‹è½½å®‰è£…</strong></p>
<p>1.å»githubå®˜ç½‘æœç´¢docker-compose,ä¸‹è½½Docker-Compose</p>
<p>docker-compose-Linux-x86_64</p>
<p>2.å°†ä¸‹è½½å¥½çš„æ–‡ä»¶ï¼Œæ‹–æ‹½åˆ°Liuxæ“ä½œç³»ç»Ÿä¸­</p>
<p>3.éœ€è¦å°†DockerComposeæ–‡ä»¶çš„åç§°ä¿®æ”¹ä¸€ä¸‹ï¼ŒåŸºäºDockerComposeæ–‡ä»¶ä¸€ä¸ªå¯æ‰§è¡Œçš„æƒé™</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>[root@localhost compose]# mv docker-compose-linux-x86_64 docker-compose
</span></span><span style="display:flex;"><span>[root@localhost compose]# mv docker-compose /usr/local/bin    //æ”¾åˆ°è·¯å¾„ä¸­
</span></span><span style="display:flex;"><span>[root@localhost compose]# cd /usr/local/bin
</span></span><span style="display:flex;"><span>[root@localhost bin]# ls
</span></span><span style="display:flex;"><span>docker-compose
</span></span><span style="display:flex;"><span>[root@localhost bin]# chmod 777 docker-compose   		 	//å¯æ‰§è¡Œæƒé™
</span></span><span style="display:flex;"><span>[root@localhost bin]# ls -al
</span></span><span style="display:flex;"><span>total 3000
</span></span><span style="display:flex;"><span>drwxr-xr-x.  2 root   root        28 Sep  7 23:23 .
</span></span><span style="display:flex;"><span>drwxr-xr-x. 12 root   root       131 Aug 14 01:15 ..
</span></span><span style="display:flex;"><span>-rwxrwxrwx.  1 linbin linbin 3072000 Sep  7 23:19 docker-compose
</span></span><span style="display:flex;"><span>[root@localhost bin]# 
</span></span></code></pre></div><p>4.æ–¹ä¾¿åæœŸæ“ä½œï¼Œé…ç½®ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œè®©åœ¨å…¶ä»–ç›®å½•ä¹Ÿå¯ä»¥æ‰§è¡Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>vi /etc/profile
</span></span></code></pre></div><h2 id="yml-æ–‡ä»¶">yml æ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#yml-æ–‡ä»¶">#</a></h2>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/Bin-lin-rgb/blog-img@main/image-20220908151305035.png" alt=""  />

<img loading="lazy" src="https://cdn.jsdelivr.net/gh/Bin-lin-rgb/blog-img@main/image-20220908151347561-16626212288662.png" alt=""  />

<img loading="lazy" src="https://cdn.jsdelivr.net/gh/Bin-lin-rgb/blog-img@main/image-20220908151424729.png" alt=""  />
</p>
<h2 id="jenkins-gitlab">Jenkins gitlab<a hidden class="anchor" aria-hidden="true" href="#jenkins-gitlab">#</a></h2>
<h3 id="jenkins-sh">Jenkins sh<a hidden class="anchor" aria-hidden="true" href="#jenkins-sh">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>docker stop jenkins &gt; /dev/null 2&gt; /dev/null <span style="color:#ff6ac1">||</span> :
</span></span><span style="display:flex;"><span>docker container rm jenkins &gt; /dev/null 2&gt; /dev/null <span style="color:#ff6ac1">||</span> :
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker run <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  --name jenkins <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  -d <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  -p 8080:8080 <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  -p 50000:50000 <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  -v jenkins_home:/var/jenkins_home:z <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  --env<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;JENKINS_OPTS=--prefix=/jenkins&#34;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  -v deploy:/var/deploy:z <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  --network bridge <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  jenkins:1.0
</span></span></code></pre></div><h3 id="gitlab-sh">gitlab sh<a hidden class="anchor" aria-hidden="true" href="#gitlab-sh">#</a></h3>
<p>docker pull gitlab/gitlab-ce:15.4.0-ce.0</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>docker stop gitlab &gt; /dev/null 2&gt; /dev/null <span style="color:#ff6ac1">||</span> :
</span></span><span style="display:flex;"><span>docker container rm gitlab &gt; /dev/null 2&gt; /dev/null <span style="color:#ff6ac1">||</span> :
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>docker run -d <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  --name gitlab <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  --hostname my-gitlab <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  --publish 19080:80 --publish 19022:22 <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  --restart always <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  --volume /gitLabs/config:/etc/gitlab:Z <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  --volume /gitLabs/logs:/var/log/gitlab:Z <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  --volume /gitLabs/data:/var/opt/gitlab:Z <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>  gitlab/gitlab-ce:15.4.0-ce.0
</span></span><span style="display:flex;"><span>  
</span></span></code></pre></div><p><a href="https://www.cnblogs.com/diaomina/p/12830449.html">https://www.cnblogs.com/diaomina/p/12830449.html</a></p>
<p>ä¿®æ”¹ hostname</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>vi  /opt/gitlab/embedded/service/gitlab-rails/config/gitlab.yml
</span></span></code></pre></div><h2 id="windows-ç¼–è¯‘åéƒ¨ç½²-juejin">Windows ç¼–è¯‘åéƒ¨ç½² [juejin]<a hidden class="anchor" aria-hidden="true" href="#windows-ç¼–è¯‘åéƒ¨ç½²-juejin">#</a></h2>
<h3 id="server">server<a hidden class="anchor" aria-hidden="true" href="#server">#</a></h3>
<p>windows ç¼–è¯‘</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>// æ³¨æ„ --&gt; ä½¿ç”¨ cmd è€Œä¸æ˜¯ powershell
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SET GOOS=linux
</span></span><span style="display:flex;"><span>SET GOARCH=amd64
</span></span><span style="display:flex;"><span>go build ./main.go
</span></span></code></pre></div><p>å°†ç¼–è¯‘å½¢æˆçš„äºŒè¿›åˆ¶æ–‡ä»¶</p>
<p>dockerfile</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">FROM alpine:latest</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">RUN mkdir &#34;/app&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">RUN mkdir &#34;/app/config&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">WORKDIR &#34;/app&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">COPY main /app/</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">COPY config.ini /app/config/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">ENTRYPOINT [&#34;./main&#34;]</span>
</span></span></code></pre></div><p>åœ¨ Linux ä¸‹çš„ docker æ‰“åŒ…æ„å»ºé•œåƒ</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">sudo docker image build --platform linux/amd64 -t juejin_blog:v2.2 . </span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">docker image ls</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">sudo docker run -it -p 9000:9000 juejin_blog:v2.2</span>
</span></span></code></pre></div><h3 id="nginx">nginx<a hidden class="anchor" aria-hidden="true" href="#nginx">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">docker pull nginx</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">;æ–°å»ºç›®å½•ç»“æ„ï¼šnginxæ–‡ä»¶å¤¹ä¸‹æ–°å»ºconf.dæ–‡ä»¶å¤¹ï¼Œhtmlæ–‡ä»¶å¤¹</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">/docker</span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">|---juejin</span>
</span></span><span style="display:flex;"><span>           <span style="color:#57c7ff">|----nginx</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#57c7ff">|----conf.d</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#57c7ff">|----html</span>
</span></span></code></pre></div><p>default.conf</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">server {</span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">listen       80;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">server_name  49.109.50.48;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">location / {</span>
</span></span><span style="display:flex;"><span>        <span style="color:#57c7ff">root   /usr/share/nginx/html;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#57c7ff">try_files $uri $uri/ /index.html;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#57c7ff">index  index.html index.htm;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">location /api/ {</span>
</span></span><span style="display:flex;"><span>        <span style="color:#57c7ff">proxy_pass http://49.109.50.48:9000;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#57c7ff">proxy_redirect default;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#57c7ff">rewrite ^/api/(.*) /$1 break;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">error_page   500 502 503 504  /50x.html;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">location</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">/50x.html {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        root   html;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    }</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">}</span>
</span></span></code></pre></div><p>run.sh</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">sudo docker run -d -p 80:80 \</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">--name nginx_v1.3 \</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">-v /docker/juejin/nginx/conf.d:/etc/nginx/conf.d  \</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">-v /docker/juejin/nginx/html/dist:/usr/share/nginx/html \</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">nginx:latest</span>
</span></span></code></pre></div><h2 id="å…ˆç”¨-builder-æ„å»ºå†-run-sms">å…ˆç”¨ builder æ„å»ºå† run [sms]<a hidden class="anchor" aria-hidden="true" href="#å…ˆç”¨-builder-æ„å»ºå†-run-sms">#</a></h2>
<h3 id="go-dockerfile">go dockerfile<a hidden class="anchor" aria-hidden="true" href="#go-dockerfile">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>FROM golang:alpine as builder
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ENV GOPROXY=https://goproxy.cn,direct
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>WORKDIR /home
</span></span><span style="display:flex;"><span>COPY . .
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>RUN go mod tidy
</span></span><span style="display:flex;"><span>RUN go build -o sms main.go
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>FROM alpine as runner
</span></span><span style="display:flex;"><span>ENV WORKDIR=/home
</span></span><span style="display:flex;"><span>WORKDIR $WORKDIR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>RUN apk add tzdata --no-cache \
</span></span><span style="display:flex;"><span>    &amp;&amp; cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \
</span></span><span style="display:flex;"><span>    &amp;&amp; echo &#34;Asia/Shanghai&#34; &gt; /etc/timezone \
</span></span><span style="display:flex;"><span>    &amp;&amp; apk del tzdata
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>COPY --from=builder $WORKDIR/sms  $WORKDIR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>CMD [&#34;./sms&#34;]
</span></span></code></pre></div><h3 id="nginx-dockerfile">nginx dockerfile<a hidden class="anchor" aria-hidden="true" href="#nginx-dockerfile">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>â””â”€frontend
</span></span><span style="display:flex;"><span>    â”œâ”€conf.d
</span></span><span style="display:flex;"><span>    â””â”€html
</span></span><span style="display:flex;"><span>        â””â”€dist
</span></span><span style="display:flex;"><span>            â””â”€assets
</span></span></code></pre></div><p>nginx.conf</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>server {
</span></span><span style="display:flex;"><span>    listen       80;
</span></span><span style="display:flex;"><span>    server_name  43.139.40.48;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    location / {
</span></span><span style="display:flex;"><span>        root   /usr/share/nginx/html;
</span></span><span style="display:flex;"><span>        try_files $uri $uri/ /index.html;
</span></span><span style="display:flex;"><span>        index  index.html index.htm;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    location /api/ {
</span></span><span style="display:flex;"><span>        proxy_pass http://43.139.40.48:8082;
</span></span><span style="display:flex;"><span>        proxy_redirect default;
</span></span><span style="display:flex;"><span>        rewrite ^/api/(.*) /$1 break;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    error_page   500 502 503 504  /50x.html;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    location = /50x.html {
</span></span><span style="display:flex;"><span>        root   html;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># ä½¿ç”¨ Nginx ä½œä¸ºåŸºç¡€é•œåƒ
</span></span><span style="display:flex;"><span>FROM nginx:alpine
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># å°†æ„å»ºå¥½çš„å‰ç«¯åº”ç”¨é™æ€æ–‡ä»¶å¤åˆ¶åˆ° Nginx çš„ HTML ç›®å½•
</span></span><span style="display:flex;"><span>COPY ./html /usr/share/nginx/html
</span></span><span style="display:flex;"><span>COPY ./conf.d /etc/nginx/conf.d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># æš´éœ²ç«¯å£ï¼Œå¦‚æœéœ€è¦çš„è¯
</span></span><span style="display:flex;"><span>EXPOSE 80
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Nginx ä¼šè‡ªåŠ¨å¯åŠ¨ï¼Œæ— éœ€æ‰‹åŠ¨å¯åŠ¨ Nginx æœåŠ¡
</span></span></code></pre></div><h3 id="docker-compose-1">docker-compose<a hidden class="anchor" aria-hidden="true" href="#docker-compose-1">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff6ac1">version</span>: <span style="color:#5af78e">&#39;3&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">backend</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">build</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">context</span>: ./sms-backend
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">dockerfile</span>: ./Dockerfile
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">image</span>: smsbackend
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">container_name</span>: <span style="color:#5af78e">&#34;smsbackend_container&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#5af78e">&#34;8082:8080&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">environment</span>:
</span></span><span style="display:flex;"><span>      - PG_USER=postgres
</span></span><span style="display:flex;"><span>      - PG_PASSWORD=admin666
</span></span><span style="display:flex;"><span>      - PG_DBNAME=sms
</span></span><span style="display:flex;"><span>      - PG_SSLMODE=disable
</span></span><span style="display:flex;"><span>      - PG_HOST=43.139.40.48
</span></span><span style="display:flex;"><span>      - PG_PORT=5432
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">nginx</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">build</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">context</span>: ./sms-frontend
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">dockerfile</span>: ./Dockerfile
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">image</span>: nginx:sms
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">container_name</span>: <span style="color:#5af78e">&#34;smsnginx_container&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#5af78e">&#34;17000:80&#34;</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#5af78e">&#34;443:443&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">volumes</span>:
</span></span><span style="display:flex;"><span>      - /sms-frontend/conf.d:/etc/nginx/conf.d
</span></span><span style="display:flex;"><span>      - /sms-frontend/html:/usr/share/nginx/html
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">restart</span>: always
</span></span></code></pre></div><h1 id="other">other<a hidden class="anchor" aria-hidden="true" href="#other">#</a></h1>
<h2 id="wsl2-ubuntu2204-å®‰è£…-docker-å‘ç°-daemon-å¯åŠ¨å¤±è´¥">WSL2 Ubuntu22.04 å®‰è£… Docker ï¼Œå‘ç° daemon å¯åŠ¨å¤±è´¥<a hidden class="anchor" aria-hidden="true" href="#wsl2-ubuntu2204-å®‰è£…-docker-å‘ç°-daemon-å¯åŠ¨å¤±è´¥">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#57c7ff">root@LAPTOP-O0KBCH8Q:~# service docker start</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">* Starting Docker: docker                                                                                                                           [ OK ]</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@LAPTOP-O0KBCH8Q:~# docker version</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Client: Docker Engine - Community</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">Version:           20.10.18</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">API version:       1.41</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">Go version:        go1.18.6</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">Git commit:        b40c2f6</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">Built:             Thu Sep  8 23:11:43 2022</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">OS/Arch:           linux/amd64</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">Context:           default</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">Experimental:      true</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@LAPTOP-O0KBCH8Q:~# sudo systemctl enable docker</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Synchronizing state of docker.service with SysV service script with /lib/systemd/systemd-sysv-install.</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Executing: /lib/systemd/systemd-sysv-install enable docker</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@LAPTOP-O0KBCH8Q:~# /lib/systemd/systemd-sysv-install enable docker</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@LAPTOP-O0KBCH8Q:~# dockerd &amp;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">failed to start daemon: Error initializing network controller: error obtaining controller instance: unable to add return rule in DOCKER-ISOLATION-STAGE-1 chain:  (iptables failed: iptables --wait -A DOCKER-ISOLATION-STAGE-1 -j RETURN: iptables v1.8.7 (nf_tables):  RULE_APPEND failed (No such file or directory): rule in chain DOCKER-ISOLATION-STAGE-1</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">(exit status 4))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">[1]+  Exit 1                  dockerd</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@LAPTOP-O0KBCH8Q:~# iptables -L -t nat</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Warning: iptables-legacy tables present, use iptables-legacy to see them</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Chain PREROUTING (policy ACCEPT)</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">target     prot opt source               destination</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Chain INPUT (policy ACCEPT)</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">target     prot opt source               destination</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Chain OUTPUT (policy ACCEPT)</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">target     prot opt source               destination</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Chain POSTROUTING (policy ACCEPT)</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">target     prot opt source               destination</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Chain DOCKER (0 references)</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">target     prot opt source               destination</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@LAPTOP-O0KBCH8Q:~# sudo update-alternatives --config iptables</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">There are 2 choices for the alternative iptables (providing /usr/sbin/iptables).</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#57c7ff">Selection    Path                       Priority   Status</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">* 0            /usr/sbin/iptables-nft      20        auto mode</span>
</span></span><span style="display:flex;"><span>  <span style="color:#57c7ff">1            /usr/sbin/iptables-legacy   10        manual mode</span>
</span></span><span style="display:flex;"><span>  <span style="color:#57c7ff">2            /usr/sbin/iptables-nft      20        manual mode</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Press &lt;enter&gt; to keep the current choice[*], or type selection number: 1</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">update-alternatives: using /usr/sbin/iptables-legacy to provide /usr/sbin/iptables (iptables) in manual mode</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@LAPTOP-O0KBCH8Q:~# service docker start</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">* Starting Docker: docker                                                                                                                           [ OK ]</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@LAPTOP-O0KBCH8Q:~# service docker status</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">* Docker is running</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@LAPTOP-O0KBCH8Q:~# docker pull hello-world</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Using default tag: latest</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">latest: Pulling from library/hello-world</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">2db29710123e: Pull complete</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Digest: sha256:62af9efd515a25f84961b70f973a798d2eca956b1b2b026d0a4a63a3b0b6a3f2</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Status: Downloaded newer image for hello-world:latest</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">docker.io/library/hello-world:latest</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">root@LAPTOP-O0KBCH8Q:~# docker run hello-world</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Hello from Docker!</span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">This message shows that your installation appears to be working correctly.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">To generate this message, Docker took the following steps:</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">1. The Docker client contacted the Docker daemon.</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">2. The Docker daemon pulled the &#34;hello-world&#34; image from the Docker Hub.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">(amd64)</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">3. The Docker daemon created a new container from that image which runs the</span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">executable that produces the output you are currently reading.</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">4. The Docker daemon streamed that output to the Docker client, which sent it</span>
</span></span><span style="display:flex;"><span>    <span style="color:#57c7ff">to your terminal.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">To try something more ambitious, you can run an Ubuntu container with:</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">$ docker run -it ubuntu bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">Share images, automate workflows, and more with a free Docker ID:</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">https://hub.docker.com/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57c7ff">For more examples and ideas, visit:</span>
</span></span><span style="display:flex;"><span> <span style="color:#57c7ff">https://docs.docker.com/get-started/</span>
</span></span></code></pre></div><h2 id="docker-error-response-from-daemon-network-qnear-not-found">docker: Error response from daemon: network qnear not found.<a hidden class="anchor" aria-hidden="true" href="#docker-error-response-from-daemon-network-qnear-not-found">#</a></h2>
<p>æ”¹æˆ bridge ã€‚</p>


        </div>
        <div class="post-reward">
            <div style="padding: 0 0 0 0; margin: 0 0 0 0; width: 100%; font-size:16px; text-align: center;">
                <div id="QR" style="opacity: 0;">
                    <div id="wechat" style="display: inline-block">
                        <a class="fancybox" rel="group">
                            <img id="wechat_qr" src="https://Bin-lin-rgb.github.io/img/wechat_pay.png" alt="wechat_pay"></a>
                        <p>å¾®ä¿¡</p>
                    </div>
                    <div id="alipay" style="display: inline-block">
                        <a class="fancybox" rel="group">
                            <img id="alipay_qr" src="https://Bin-lin-rgb.github.io/img/alipay.png" alt="alipay"></a>
                        <p>æ”¯ä»˜å®</p>
                    </div>
                </div>
                <button id="rewardButton"
                        onclick="
                    var qr = document.getElementById('QR');
                    if (qr.style.opacity === '0') {
                        qr.style.opacity='1';
                    } else {
                        qr.style.opacity='0'
                    }"
                >
                    <span>ğŸ§§ é¼“åŠ±</span>
                </button>
            </div>
        </div>

        <footer class="post-footer">
            
<nav class="paginav">
  <a class="prev" href="https://Bin-lin-rgb.github.io/posts/leetcode/top150/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>Top150</span>
  </a>
  <a class="next" href="https://Bin-lin-rgb.github.io/posts/tech/tech/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>Redis scanå‘½ä»¤å­¦ä¹ </span>
  </a>
</nav>

        </footer>
    </div>

<style>
    .comments_details summary::marker {
        font-size: 20px;
        content: 'ğŸ‘‰å±•å¼€è¯„è®º';
        color: var(--content);
    }
    .comments_details[open] summary::marker{
        font-size: 20px;
        content: 'ğŸ‘‡å…³é—­è¯„è®º';
        color: var(--content);
    }
</style>


<div>
    <details class="comments_details">
        <summary style="cursor: pointer; margin: 50px 0 20px 0;width: 130px;">
            <span style="font-size: 20px;color: var(--content);">...</span>
        </summary>
        <div id="tcomment"></div>
    </details>
    <script src="https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js">
    </script>
    <script>
        twikoo.init({
            envId: 'https://twikoo-api-nine-silk.vercel.app/',
            el: "#tcomment",
            lang: 'zh-CN',
            region: 'ap-guangzhou',
            path: window.TWIKOO_MAGIC_PATH||window.location.pathname,
        })
    
    
    
    
    
    
    
    </script>
</div>
</article>
</main>

<footer class="footer">
    <span>
        Copyright
        &copy;
        2021-2023
        <a href="https://Bin-lin-rgb.github.io/" style="color:#939393;">Blaine&#39;s Blog</a>
        All Rights Reserved
    </span>
    <a href="https://beian.miit.gov.cn/" target="_blank" style="color:#939393;">å¤‡æ¡ˆå·</a>&nbsp;
    <span>
        <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=null"
           style="display:inline-block;text-decoration:none;height:20px;color:#939393;">
            <img src="%e5%85%ac%e5%ae%89%e5%9b%be%e6%a0%87%e9%93%be%e6%8e%a5" style="float:left;margin: 0px 5px 0px 0px;"/>
            å…¬ç½‘å®‰å¤‡
        </a>
    </span>
    <span id="busuanzi_container">
        <span class="fa fa-user"></span> <span id="busuanzi_value_site_uv"></span>
        <span class="fa fa-eye"></span> <span id="busuanzi_value_site_pv"></span>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <span class="topInner">
        <svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z"/>
        </svg>
        <span id="read_progress"></span>
    </span>
</a>

<script>
    document.addEventListener('scroll', function (e) {
        const readProgress = document.getElementById("read_progress");
        const scrollHeight = document.documentElement.scrollHeight;
        const clientHeight = document.documentElement.clientHeight;
        const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        readProgress.innerText = ((scrollTop / (scrollHeight - clientHeight)).toFixed(2) * 100).toFixed(0);
    })
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
</script>
<script>
    let mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        (function() {
            document.cookie = "change-themes" + "="+ escape ("false");
        })()

        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    });
</script>

<script>
    document.body.addEventListener('copy', function (e) {
        if (window.getSelection().toString() && window.getSelection().toString().length > 50) {
            let clipboardData = e.clipboardData || window.clipboardData;
            if (clipboardData) {
                e.preventDefault();
                let htmlData = window.getSelection().toString() +
                    '\r\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' +
                    'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"Blaine's Blog"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' +
                '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                let textData = window.getSelection().toString() +
                    '\r\n\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' +
                    'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"Blaine's Blog"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' +
                '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                clipboardData.setData('text/html', htmlData);
                clipboardData.setData('text/plain', textData);
            }
        }
    });
</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;
        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerText = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerText = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                let text = codeblock.textContent +
                    '\r\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\n' +
                    'ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºã€Œ'+"Blaine's Blog"+'ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚' +
                '\r\nåŸæ–‡é“¾æ¥ï¼š' + location.href;
                navigator.clipboard.writeText(text);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {}
            selection.removeRange(range);
        });

        let language = codeblock.className.replaceAll("language-", "")
        let macTool = document.createElement("div")
        let macTool1 = document.createElement("div")
        let macTool2 = document.createElement("div")
        let macTool3 = document.createElement("div")
        let languageType = document.createElement("div")
        languageType.innerText = language
        macTool.setAttribute('class', 'mac-tool')
        macTool1.setAttribute('class', 'mac bb1')
        macTool2.setAttribute('class', 'mac bb2')
        macTool3.setAttribute('class', 'mac bb3')
        languageType.setAttribute('class', 'language-type')
        macTool.appendChild(macTool1)
        macTool.appendChild(macTool2)
        macTool.appendChild(macTool3)
        macTool.appendChild(languageType)

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
            container.appendChild(macTool)
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        }
    });
</script>
</body>

</html>
